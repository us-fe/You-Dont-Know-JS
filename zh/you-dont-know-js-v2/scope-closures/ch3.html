<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.38">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <title>You Don't Know JS Yet: Scope & Closures - 2nd Edition | US-FE</title><meta name="description" content="US-FE eBoks">
    <link rel="modulepreload" href="/ebooks/assets/app.a957722f.js"><link rel="modulepreload" href="/ebooks/assets/ch3.html.ea45d6b3.js"><link rel="modulepreload" href="/ebooks/assets/ch3.html.77746cba.js">
    <link rel="stylesheet" href="/ebooks/assets/style.6c500c23.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/ebooks/zh/" class=""><img class="logo" src="https://vuejs.org/images/logo.png" alt="US-FE"><span class="site-name can-hide">US-FE</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a class="external-link" href="https://us-fe.github.io" rel="noopener noreferrer" target="_blank" aria-label="US-FE"><!--[--><!--]--> US-FE <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a href="/ebooks/" class="router-link-active" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="You Don&#39;t Know JS"><span class="title">You Don&#39;t Know JS</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="You Don&#39;t Know JS"><span class="title">You Don&#39;t Know JS</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>V1</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/ebooks/zh/you-dont-know-js-v1/up-going/" class="" aria-label="Up &amp; Going"><!--[--><!--]--> Up &amp; Going <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ebooks/zh/you-dont-know-js-v1/scope-closures/" class="" aria-label="Scope &amp; Closures"><!--[--><!--]--> Scope &amp; Closures <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ebooks/zh/you-dont-know-js-v1/this-object-prototypes/" class="" aria-label="This &amp; Object Prototypes"><!--[--><!--]--> This &amp; Object Prototypes <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ebooks/zh/you-dont-know-js-v1/types-grammar/" class="" aria-label="Types &amp; Grammar"><!--[--><!--]--> Types &amp; Grammar <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ebooks/zh/you-dont-know-js-v1/async-performance/" class="" aria-label="Async &amp; Performance"><!--[--><!--]--> Async &amp; Performance <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ebooks/zh/you-dont-know-js-v1/es6-beyond/" class="" aria-label="ES6 &amp; Beyond"><!--[--><!--]--> ES6 &amp; Beyond <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>V2</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/ebooks/zh/you-dont-know-js-v2/get-started/" class="" aria-label="Get Started"><!--[--><!--]--> Get Started <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ebooks/zh/you-dont-know-js-v2/scope-closures/" class="router-link-active" aria-label="Scope &amp; Closures"><!--[--><!--]--> Scope &amp; Closures <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Professional Javascript for Web Developers V4"><span class="title">Professional Javascript for Web Developers V4</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Professional Javascript for Web Developers V4"><span class="title">Professional Javascript for Web Developers V4</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch1-what-is-javascript" class="" aria-label="Chapter 1: What Is JavaScript?"><!--[--><!--]--> Chapter 1: What Is JavaScript? <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch2-javascript-in-html" class="" aria-label="Chapter 2: JavaScript in HTML"><!--[--><!--]--> Chapter 2: JavaScript in HTML <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch3-language-basics" class="" aria-label="Chapter 3: Language Basics"><!--[--><!--]--> Chapter 3: Language Basics <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch4-variables-scope-and-memory" class="" aria-label="Chapter 4: Variables, Scope, and Memory"><!--[--><!--]--> Chapter 4: Variables, Scope, and Memory <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch5-basic-reference-types" class="" aria-label="Chapter 5: Basic Reference Types"><!--[--><!--]--> Chapter 5: Basic Reference Types <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch6-collection-reference-types" class="" aria-label="Chapter 6: Collection Reference Types"><!--[--><!--]--> Chapter 6: Collection Reference Types <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch7-iterators-and-generators" class="" aria-label="Chapter 7: Iterators and Generators"><!--[--><!--]--> Chapter 7: Iterators and Generators <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch8-objects-classes-and-object-oriented-programming" class="" aria-label="Chapter 8: Objects, Classes, and Object-Oriented Programming"><!--[--><!--]--> Chapter 8: Objects, Classes, and Object-Oriented Programming <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch9-proxies-and-reflect" class="" aria-label="Chapter 9: Proxies and Reflect"><!--[--><!--]--> Chapter 9: Proxies and Reflect <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch10-funtions" class="" aria-label="Chapter 10: Functions"><!--[--><!--]--> Chapter 10: Functions <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch11-promises-and-async-functions" class="" aria-label="Chapter 11: Promises and Async Functions"><!--[--><!--]--> Chapter 11: Promises and Async Functions <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch12-the-browser-object-model" class="" aria-label="Chapter 12: The Browser Object Model"><!--[--><!--]--> Chapter 12: The Browser Object Model <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch13-client-detection" class="" aria-label="Chapter 13: Client Detection"><!--[--><!--]--> Chapter 13: Client Detection <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch14-the-document-object-model" class="" aria-label="Chapter 14: The Document Object Model"><!--[--><!--]--> Chapter 14: The Document Object Model <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch15-dom-extensions" class="" aria-label="Chapter 15: DOM Extensions"><!--[--><!--]--> Chapter 15: DOM Extensions <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch16-dom-levels-2-and-3" class="" aria-label="Chapter 16: DOM Levels 2 and 3"><!--[--><!--]--> Chapter 16: DOM Levels 2 and 3 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch17-events" class="" aria-label="Chapter 17: Events"><!--[--><!--]--> Chapter 17: Events <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch18-animation-and-graphics-with-canvas" class="" aria-label="Chapter 18: Animation and Graphics with Canvas"><!--[--><!--]--> Chapter 18: Animation and Graphics with Canvas <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch19-scripting-forms" class="" aria-label="Chapter 19: Scripting Forms"><!--[--><!--]--> Chapter 19: Scripting Forms <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch20-javascript-apis" class="" aria-label="Chapter 20: JavaScript APIs"><!--[--><!--]--> Chapter 20: JavaScript APIs <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch21-error-handling-and-debugging" class="" aria-label="Chapter 21: Error Handling and Debugging"><!--[--><!--]--> Chapter 21: Error Handling and Debugging <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch22-xml-in-javascript" class="" aria-label="Chapter 22: XML in JavaScript"><!--[--><!--]--> Chapter 22: XML in JavaScript <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch23-json" class="" aria-label="Chapter 23: JSON"><!--[--><!--]--> Chapter 23: JSON <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch24-network-requests-and-remote-resources" class="" aria-label="Chapter 24: Network Requests and Remote Resources"><!--[--><!--]--> Chapter 24: Network Requests and Remote Resources <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch25-client-side-storage" class="" aria-label="Chapter 25: Client-Side Storage"><!--[--><!--]--> Chapter 25: Client-Side Storage <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch26-modules" class="" aria-label="Chapter 26: Modules"><!--[--><!--]--> Chapter 26: Modules <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch27-workers" class="" aria-label="Chapter 27: Workers"><!--[--><!--]--> Chapter 27: Workers <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch28-best-practices" class="" aria-label="Chapter 28: Best Practices"><!--[--><!--]--> Chapter 28: Best Practices <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/apA-es2018-and-es2019" class="" aria-label="Appendix A: ES2018 and ES2019"><!--[--><!--]--> Appendix A: ES2018 and ES2019 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/apB-strct-mode" class="" aria-label="Appendix B: Strict Mode"><!--[--><!--]--> Appendix B: Strict Mode <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/apC-javascript-libraries-and-frameworks" class="" aria-label="Appendix C: JavaScript Libraries and Frameworks"><!--[--><!--]--> Appendix C: JavaScript Libraries and Frameworks <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/apD-javascript-tools" class="" aria-label="Appendix D: JavasScript Tools"><!--[--><!--]--> Appendix D: JavasScript Tools <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">Languages</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a aria-current="page" href="/ebooks/zh/you-dont-know-js-v2/scope-closures/ch3.html" class="router-link-active router-link-exact-active router-link-active" aria-label="简体中文"><!--[--><!--]--> 简体中文 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/you-dont-know-js-v2/scope-closures/ch3.html" class="" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/us-fe/ebooks" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a class="external-link" href="https://us-fe.github.io" rel="noopener noreferrer" target="_blank" aria-label="US-FE"><!--[--><!--]--> US-FE <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a href="/ebooks/" class="router-link-active" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="You Don&#39;t Know JS"><span class="title">You Don&#39;t Know JS</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="You Don&#39;t Know JS"><span class="title">You Don&#39;t Know JS</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>V1</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/ebooks/zh/you-dont-know-js-v1/up-going/" class="" aria-label="Up &amp; Going"><!--[--><!--]--> Up &amp; Going <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ebooks/zh/you-dont-know-js-v1/scope-closures/" class="" aria-label="Scope &amp; Closures"><!--[--><!--]--> Scope &amp; Closures <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ebooks/zh/you-dont-know-js-v1/this-object-prototypes/" class="" aria-label="This &amp; Object Prototypes"><!--[--><!--]--> This &amp; Object Prototypes <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ebooks/zh/you-dont-know-js-v1/types-grammar/" class="" aria-label="Types &amp; Grammar"><!--[--><!--]--> Types &amp; Grammar <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ebooks/zh/you-dont-know-js-v1/async-performance/" class="" aria-label="Async &amp; Performance"><!--[--><!--]--> Async &amp; Performance <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ebooks/zh/you-dont-know-js-v1/es6-beyond/" class="" aria-label="ES6 &amp; Beyond"><!--[--><!--]--> ES6 &amp; Beyond <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>V2</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/ebooks/zh/you-dont-know-js-v2/get-started/" class="" aria-label="Get Started"><!--[--><!--]--> Get Started <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ebooks/zh/you-dont-know-js-v2/scope-closures/" class="router-link-active" aria-label="Scope &amp; Closures"><!--[--><!--]--> Scope &amp; Closures <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Professional Javascript for Web Developers V4"><span class="title">Professional Javascript for Web Developers V4</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Professional Javascript for Web Developers V4"><span class="title">Professional Javascript for Web Developers V4</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch1-what-is-javascript" class="" aria-label="Chapter 1: What Is JavaScript?"><!--[--><!--]--> Chapter 1: What Is JavaScript? <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch2-javascript-in-html" class="" aria-label="Chapter 2: JavaScript in HTML"><!--[--><!--]--> Chapter 2: JavaScript in HTML <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch3-language-basics" class="" aria-label="Chapter 3: Language Basics"><!--[--><!--]--> Chapter 3: Language Basics <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch4-variables-scope-and-memory" class="" aria-label="Chapter 4: Variables, Scope, and Memory"><!--[--><!--]--> Chapter 4: Variables, Scope, and Memory <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch5-basic-reference-types" class="" aria-label="Chapter 5: Basic Reference Types"><!--[--><!--]--> Chapter 5: Basic Reference Types <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch6-collection-reference-types" class="" aria-label="Chapter 6: Collection Reference Types"><!--[--><!--]--> Chapter 6: Collection Reference Types <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch7-iterators-and-generators" class="" aria-label="Chapter 7: Iterators and Generators"><!--[--><!--]--> Chapter 7: Iterators and Generators <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch8-objects-classes-and-object-oriented-programming" class="" aria-label="Chapter 8: Objects, Classes, and Object-Oriented Programming"><!--[--><!--]--> Chapter 8: Objects, Classes, and Object-Oriented Programming <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch9-proxies-and-reflect" class="" aria-label="Chapter 9: Proxies and Reflect"><!--[--><!--]--> Chapter 9: Proxies and Reflect <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch10-funtions" class="" aria-label="Chapter 10: Functions"><!--[--><!--]--> Chapter 10: Functions <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch11-promises-and-async-functions" class="" aria-label="Chapter 11: Promises and Async Functions"><!--[--><!--]--> Chapter 11: Promises and Async Functions <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch12-the-browser-object-model" class="" aria-label="Chapter 12: The Browser Object Model"><!--[--><!--]--> Chapter 12: The Browser Object Model <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch13-client-detection" class="" aria-label="Chapter 13: Client Detection"><!--[--><!--]--> Chapter 13: Client Detection <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch14-the-document-object-model" class="" aria-label="Chapter 14: The Document Object Model"><!--[--><!--]--> Chapter 14: The Document Object Model <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch15-dom-extensions" class="" aria-label="Chapter 15: DOM Extensions"><!--[--><!--]--> Chapter 15: DOM Extensions <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch16-dom-levels-2-and-3" class="" aria-label="Chapter 16: DOM Levels 2 and 3"><!--[--><!--]--> Chapter 16: DOM Levels 2 and 3 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch17-events" class="" aria-label="Chapter 17: Events"><!--[--><!--]--> Chapter 17: Events <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch18-animation-and-graphics-with-canvas" class="" aria-label="Chapter 18: Animation and Graphics with Canvas"><!--[--><!--]--> Chapter 18: Animation and Graphics with Canvas <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch19-scripting-forms" class="" aria-label="Chapter 19: Scripting Forms"><!--[--><!--]--> Chapter 19: Scripting Forms <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch20-javascript-apis" class="" aria-label="Chapter 20: JavaScript APIs"><!--[--><!--]--> Chapter 20: JavaScript APIs <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch21-error-handling-and-debugging" class="" aria-label="Chapter 21: Error Handling and Debugging"><!--[--><!--]--> Chapter 21: Error Handling and Debugging <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch22-xml-in-javascript" class="" aria-label="Chapter 22: XML in JavaScript"><!--[--><!--]--> Chapter 22: XML in JavaScript <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch23-json" class="" aria-label="Chapter 23: JSON"><!--[--><!--]--> Chapter 23: JSON <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch24-network-requests-and-remote-resources" class="" aria-label="Chapter 24: Network Requests and Remote Resources"><!--[--><!--]--> Chapter 24: Network Requests and Remote Resources <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch25-client-side-storage" class="" aria-label="Chapter 25: Client-Side Storage"><!--[--><!--]--> Chapter 25: Client-Side Storage <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch26-modules" class="" aria-label="Chapter 26: Modules"><!--[--><!--]--> Chapter 26: Modules <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch27-workers" class="" aria-label="Chapter 27: Workers"><!--[--><!--]--> Chapter 27: Workers <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch28-best-practices" class="" aria-label="Chapter 28: Best Practices"><!--[--><!--]--> Chapter 28: Best Practices <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/apA-es2018-and-es2019" class="" aria-label="Appendix A: ES2018 and ES2019"><!--[--><!--]--> Appendix A: ES2018 and ES2019 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/apB-strct-mode" class="" aria-label="Appendix B: Strict Mode"><!--[--><!--]--> Appendix B: Strict Mode <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/apC-javascript-libraries-and-frameworks" class="" aria-label="Appendix C: JavaScript Libraries and Frameworks"><!--[--><!--]--> Appendix C: JavaScript Libraries and Frameworks <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/apD-javascript-tools" class="" aria-label="Appendix D: JavasScript Tools"><!--[--><!--]--> Appendix D: JavasScript Tools <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">Languages</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a aria-current="page" href="/ebooks/zh/you-dont-know-js-v2/scope-closures/ch3.html" class="router-link-active router-link-exact-active router-link-active" aria-label="简体中文"><!--[--><!--]--> 简体中文 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/you-dont-know-js-v2/scope-closures/ch3.html" class="" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/us-fe/ebooks" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">Get Started <span class="right arrow"></span></p><!--[--><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/ebooks/zh/you-dont-know-js-v2/get-started/" class="sidebar-item" aria-label="README"><!--[--><!--]--> README <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v2/get-started/ch1" class="sidebar-item" aria-label="Chapter 1: What *Is* JavaScript?"><!--[--><!--]--> Chapter 1: What *Is* JavaScript? <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v2/get-started/ch2" class="sidebar-item" aria-label="Chapter 2: Surveying JS"><!--[--><!--]--> Chapter 2: Surveying JS <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v2/get-started/ch3" class="sidebar-item" aria-label="Chapter 3: Digging to the Roots of JS"><!--[--><!--]--> Chapter 3: Digging to the Roots of JS <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v2/get-started/ch3" class="sidebar-item" aria-label="Chapter 4: The Bigger Picture"><!--[--><!--]--> Chapter 4: The Bigger Picture <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v2/get-started/apA" class="sidebar-item" aria-label="Appendix A: Exploring Further"><!--[--><!--]--> Appendix A: Exploring Further <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v2/get-started/apB" class="sidebar-item" aria-label="Appendix B: Practice, Practice, Practice!"><!--[--><!--]--> Appendix B: Practice, Practice, Practice! <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><p tabindex="0" class="sidebar-item sidebar-heading active collapsible">Scope &amp; Closures <span class="down arrow"></span></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a href="/ebooks/zh/you-dont-know-js-v2/scope-closures/" class="router-link-active sidebar-item" aria-label="README"><!--[--><!--]--> README <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v2/scope-closures/toc" class="sidebar-item" aria-label="TOC"><!--[--><!--]--> TOC <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v2/scope-closures/ch1" class="sidebar-item" aria-label="Chapter 1: What&#39;s the Scope?"><!--[--><!--]--> Chapter 1: What&#39;s the Scope? <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v2/scope-closures/ch2" class="sidebar-item" aria-label="Chapter 2: Illustrating Lexical Scope"><!--[--><!--]--> Chapter 2: Illustrating Lexical Scope <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v2/scope-closures/ch3" class="router-link-active sidebar-item active" aria-label="Chapter 3: The Scope Chain"><!--[--><!--]--> Chapter 3: The Scope Chain <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v2/scope-closures/ch4" class="sidebar-item" aria-label="Chapter 4: Around the Global Scope"><!--[--><!--]--> Chapter 4: Around the Global Scope <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v2/scope-closures/ch5" class="sidebar-item" aria-label="Chapter 5: The (Not So) Secret Lifecycle of Variables"><!--[--><!--]--> Chapter 5: The (Not So) Secret Lifecycle of Variables <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v2/scope-closures/ch6" class="sidebar-item" aria-label="Chapter 6: Limiting Scope Exposure"><!--[--><!--]--> Chapter 6: Limiting Scope Exposure <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v2/scope-closures/ch7" class="sidebar-item" aria-label="Chapter 7: Using Closures"><!--[--><!--]--> Chapter 7: Using Closures <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v2/scope-closures/ch8" class="sidebar-item" aria-label="Chapter 8: The Module Pattern"><!--[--><!--]--> Chapter 8: The Module Pattern <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v2/scope-closures/apA" class="sidebar-item" aria-label="Appendix A: Exploring Further"><!--[--><!--]--> Appendix A: Exploring Further <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v2/scope-closures/apB" class="sidebar-item" aria-label="Appendix B: Practice"><!--[--><!--]--> Appendix B: Practice <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="you-don-t-know-js-yet-scope-closures-2nd-edition" tabindex="-1"><a class="header-anchor" href="#you-don-t-know-js-yet-scope-closures-2nd-edition" aria-hidden="true">#</a> You Don&#39;t Know JS Yet: Scope &amp; Closures - 2nd Edition</h1><h1 id="chapter-3-the-scope-chain" tabindex="-1"><a class="header-anchor" href="#chapter-3-the-scope-chain" aria-hidden="true">#</a> Chapter 3: The Scope Chain</h1><p>Chapters 1 and 2 laid down a concrete definition of <em>lexical scope</em> (and its parts) and illustrated helpful metaphors for its conceptual foundation. Before proceeding with this chapter, find someone else to explain (written or aloud), in your own words, what lexical scope is and why it&#39;s useful to understand.</p><p>That seems like a step you might skip, but I&#39;ve found it really does help to take the time to reformulate these ideas as explanations to others. That helps our brains digest what we&#39;re learning!</p><p>Now it&#39;s time to dig into the nuts and bolts, so expect that things will get a lot more detailed from here forward. Stick with it, though, because these discussions really hammer home just how much we all <em>don&#39;t know</em> about scope, yet. Make sure to take your time with the text and all the code snippets provided.</p><p>To refresh the context of our running example, let&#39;s recall the color-coded illustration of the nested scope bubbles, from Chapter 2, Figure 2:</p><figure><img src="/ebooks/you-dont-know-js-v2/scope-closures/images/fig2.png" width="500" alt="Colored Scope Bubbles" align="center"><figcaption><em>Fig. 2 (Ch. 2): Colored Scope Bubbles</em></figcaption><br><br></figure><p>The connections between scopes that are nested within other scopes is called the scope chain, which determines the path along which variables can be accessed. The chain is directed, meaning the lookup moves upward/outward only.</p><h2 id="lookup-is-mostly-conceptual" tabindex="-1"><a class="header-anchor" href="#lookup-is-mostly-conceptual" aria-hidden="true">#</a> &quot;Lookup&quot; Is (Mostly) Conceptual</h2><p>In Figure 2, notice the color of the <code>students</code> variable reference in the <code>for</code>-loop. How exactly did we determine that it&#39;s a RED(1) marble?</p><p>In Chapter 2, we described the runtime access of a variable as a &quot;lookup,&quot; where the <em>Engine</em> has to start by asking the current scope&#39;s <em>Scope Manager</em> if it knows about an identifier/variable, and proceeding upward/outward back through the chain of nested scopes (toward the global scope) until found, if ever. The lookup stops as soon as the first matching named declaration in a scope bucket is found.</p><p>The lookup process thus determined that <code>students</code> is a RED(1) marble, because we had not yet found a matching variable name as we traversed the scope chain, until we arrived at the final RED(1) global scope.</p><p>Similarly, <code>studentID</code> in the <code>if</code>-statement is determined to be a BLUE(2) marble.</p><p>This suggestion of a runtime lookup process works well for conceptual understanding, but it&#39;s not actually how things usually work in practice.</p><p>The color of a marble&#39;s bucket (aka, meta information of what scope a variable originates from) is <em>usually determined</em> during the initial compilation processing. Because lexical scope is pretty much finalized at that point, a marble&#39;s color will not change based on anything that can happen later during runtime.</p><p>Since the marble&#39;s color is known from compilation, and it&#39;s immutable, this information would likely be stored with (or at least accessible from) each variable&#39;s entry in the AST; that information is then used explicitly by the executable instructions that constitute the program&#39;s runtime.</p><p>In other words, <em>Engine</em> (from Chapter 2) doesn&#39;t need to lookup through a bunch of scopes to figure out which scope bucket a variable comes from. That information is already known! Avoiding the need for a runtime lookup is a key optimization benefit of lexical scope. The runtime operates more performantly without spending time on all these lookups.</p><p>But I said &quot;...usually determined...&quot; just a moment ago, with respect to figuring out a marble&#39;s color during compilation. So in what case would it ever <em>not</em> be known during compilation?</p><p>Consider a reference to a variable that isn&#39;t declared in any lexically available scopes in the current file—see <em>Get Started</em>, Chapter 1, which asserts that each file is its own separate program from the perspective of JS compilation. If no declaration is found, that&#39;s not <em>necessarily</em> an error. Another file (program) in the runtime may indeed declare that variable in the shared global scope.</p><p>So the ultimate determination of whether the variable was ever appropriately declared in some accessible bucket may need to be deferred to the runtime.</p><p>Any reference to a variable that&#39;s initially <em>undeclared</em> is left as an uncolored marble during that file&#39;s compilation; this color cannot be determined until other relevant file(s) have been compiled and the application runtime commences. That deferred lookup will eventually resolve the color to whichever scope the variable is found in (likely the global scope).</p><p>However, this lookup would only be needed once per variable at most, since nothing else during runtime could later change that marble&#39;s color.</p><p>The &quot;Lookup Failures&quot; section in Chapter 2 covers what happens if a marble is ultimately still uncolored at the moment its reference is runtime executed.</p><h2 id="shadowing" tabindex="-1"><a class="header-anchor" href="#shadowing" aria-hidden="true">#</a> Shadowing</h2><p>&quot;Shadowing&quot; might sound mysterious and a little bit sketchy. But don&#39;t worry, it&#39;s completely legit!</p><p>Our running example for these chapters uses different variable names across the scope boundaries. Since they all have unique names, in a way it wouldn&#39;t matter if all of them were just stored in one bucket (like RED(1)).</p><p>Where having different lexical scope buckets starts to matter more is when you have two or more variables, each in different scopes, with the same lexical names. A single scope cannot have two or more variables with the same name; such multiple references would be assumed as just one variable.</p><p>So if you need to maintain two or more variables of the same name, you must use separate (often nested) scopes. And in that case, it&#39;s very relevant how the different scope buckets are laid out.</p><p>Consider:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> studentName <span class="token operator">=</span> <span class="token string">&quot;Suzy&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">printStudent</span><span class="token punctuation">(</span><span class="token parameter">studentName</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    studentName <span class="token operator">=</span> studentName<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>studentName<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">printStudent</span><span class="token punctuation">(</span><span class="token string">&quot;Frank&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// FRANK</span>

<span class="token function">printStudent</span><span class="token punctuation">(</span>studentName<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// SUZY</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>studentName<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Suzy</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><table><thead><tr><th style="text-align:left;">TIP:</th></tr></thead><tbody><tr><td style="text-align:left;">Before you move on, take some time to analyze this code using the various techniques/metaphors we&#39;ve covered in the book. In particular, make sure to identify the marble/bubble colors in this snippet. It&#39;s good practice!</td></tr></tbody></table><p>The <code>studentName</code> variable on line 1 (the <code>var studentName = ..</code> statement) creates a RED(1) marble. The same named variable is declared as a BLUE(2) marble on line 3, the parameter in the <code>printStudent(..)</code> function definition.</p><p>What color marble will <code>studentName</code> be in the <code>studentName = studentName.toUpperCase()</code> assignment statement and the <code>console.log(studentName)</code> statement? All three <code>studentName</code> references will be BLUE(2).</p><p>With the conceptual notion of the &quot;lookup,&quot; we asserted that it starts with the current scope and works its way outward/upward, stopping as soon as a matching variable is found. The BLUE(2) <code>studentName</code> is found right away. The RED(1) <code>studentName</code> is never even considered.</p><p>This is a key aspect of lexical scope behavior, called <em>shadowing</em>. The BLUE(2) <code>studentName</code> variable (parameter) shadows the RED(1) <code>studentName</code>. So, the parameter is shadowing the (shadowed) global variable. Repeat that sentence to yourself a few times to make sure you have the terminology straight!</p><p>That&#39;s why the re-assignment of <code>studentName</code> affects only the inner (parameter) variable: the BLUE(2) <code>studentName</code>, not the global RED(1) <code>studentName</code>.</p><p>When you choose to shadow a variable from an outer scope, one direct impact is that from that scope inward/downward (through any nested scopes) it&#39;s now impossible for any marble to be colored as the shadowed variable—(RED(1), in this case). In other words, any <code>studentName</code> identifier reference will correspond to that parameter variable, never the global <code>studentName</code> variable. It&#39;s lexically impossible to reference the global <code>studentName</code> anywhere inside of the <code>printStudent(..)</code> function (or from any nested scopes).</p><h3 id="global-unshadowing-trick" tabindex="-1"><a class="header-anchor" href="#global-unshadowing-trick" aria-hidden="true">#</a> Global Unshadowing Trick</h3><p>Please beware: leveraging the technique I&#39;m about to describe is not very good practice, as it&#39;s limited in utility, confusing for readers of your code, and likely to invite bugs to your program. I&#39;m covering it only because you may run across this behavior in existing programs, and understanding what&#39;s happening is critical to not getting tripped up.</p><p>It <em>is</em> possible to access a global variable from a scope where that variable has been shadowed, but not through a typical lexical identifier reference.</p><p>In the global scope (RED(1)), <code>var</code> declarations and <code>function</code> declarations also expose themselves as properties (of the same name as the identifier) on the <em>global object</em>—essentially an object representation of the global scope. If you&#39;ve written JS for a browser environment, you probably recognize the global object as <code>window</code>. That&#39;s not <em>entirely</em> accurate, but it&#39;s good enough for our discussion. In the next chapter, we&#39;ll explore the global scope/object topic more.</p><p>Consider this program, specifically executed as a standalone .js file in a browser environment:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> studentName <span class="token operator">=</span> <span class="token string">&quot;Suzy&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">printStudent</span><span class="token punctuation">(</span><span class="token parameter">studentName</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>studentName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>studentName<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">printStudent</span><span class="token punctuation">(</span><span class="token string">&quot;Frank&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// &quot;Frank&quot;</span>
<span class="token comment">// &quot;Suzy&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>Notice the <code>window.studentName</code> reference? This expression is accessing the global variable <code>studentName</code> as a property on <code>window</code> (which we&#39;re pretending for now is synonymous with the global object). That&#39;s the only way to access a shadowed variable from inside a scope where the shadowing variable is present.</p><p>The <code>window.studentName</code> is a mirror of the global <code>studentName</code> variable, not a separate snapshot copy. Changes to one are still seen from the other, in either direction. You can think of <code>window.studentName</code> as a getter/setter that accesses the actual <code>studentName</code> variable. As a matter of fact, you can even <em>add</em> a variable to the global scope by creating/setting a property on the global object.</p><table><thead><tr><th style="text-align:left;">WARNING:</th></tr></thead><tbody><tr><td style="text-align:left;">Remember: just because you <em>can</em> doesn&#39;t mean you <em>should</em>. Don&#39;t shadow a global variable that you need to access, and conversely, avoid using this trick to access a global variable that you&#39;ve shadowed. And definitely don&#39;t confuse readers of your code by creating global variables as <code>window</code> properties instead of with formal declarations!</td></tr></tbody></table><p>This little &quot;trick&quot; only works for accessing a global scope variable (not a shadowed variable from a nested scope), and even then, only one that was declared with <code>var</code> or <code>function</code>.</p><p>Other forms of global scope declarations do not create mirrored global object properties:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> one <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> notOne <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> notTwo <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">notThree</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>one<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// 1</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>notOne<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// undefined</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>notTwo<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// undefined</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>notThree<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// undefined</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>Variables (no matter how they&#39;re declared!) that exist in any other scope than the global scope are completely inaccessible from a scope where they&#39;ve been shadowed:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> special <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">lookingFor</span><span class="token punctuation">(</span><span class="token parameter">special</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// The identifier `special` (parameter) in this</span>
    <span class="token comment">// scope is shadowed inside keepLooking(), and</span>
    <span class="token comment">// is thus inaccessible from that scope.</span>

    <span class="token keyword">function</span> <span class="token function">keepLooking</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> special <span class="token operator">=</span> <span class="token number">3.141592</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>special<span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>special<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">keepLooking</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">lookingFor</span><span class="token punctuation">(</span><span class="token number">112358132134</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 3.141592</span>
<span class="token comment">// 42</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>The global RED(1) <code>special</code> is shadowed by the BLUE(2) <code>special</code> (parameter), and the BLUE(2) <code>special</code> is itself shadowed by the GREEN(3) <code>special</code> inside <code>keepLooking()</code>. We can still access the RED(1) <code>special</code> using the indirect reference <code>window.special</code>. But there&#39;s no way for <code>keepLooking()</code> to access the BLUE(2) <code>special</code> that holds the number <code>112358132134</code>.</p><h3 id="copying-is-not-accessing" tabindex="-1"><a class="header-anchor" href="#copying-is-not-accessing" aria-hidden="true">#</a> Copying Is Not Accessing</h3><p>I&#39;ve been asked the following &quot;But what about...?&quot; question dozens of times. Consider:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> special <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">lookingFor</span><span class="token punctuation">(</span><span class="token parameter">special</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> another <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">special</span><span class="token operator">:</span> special
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">function</span> <span class="token function">keepLooking</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> special <span class="token operator">=</span> <span class="token number">3.141592</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>special<span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>another<span class="token punctuation">.</span>special<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Ooo, tricky!</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>special<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">keepLooking</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">lookingFor</span><span class="token punctuation">(</span><span class="token number">112358132134</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 3.141592</span>
<span class="token comment">// 112358132134</span>
<span class="token comment">// 42</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>Oh! So does this <code>another</code> object technique disprove my claim that the <code>special</code> parameter is &quot;completely inaccessible&quot; from inside <code>keepLooking()</code>? No, the claim is still correct.</p><p><code>special: special</code> is copying the value of the <code>special</code> parameter variable into another container (a property of the same name). Of course, if you put a value in another container, shadowing no longer applies (unless <code>another</code> was shadowed, too!). But that doesn&#39;t mean we&#39;re accessing the parameter <code>special</code>; it means we&#39;re accessing the copy of the value it had at that moment, by way of <em>another</em> container (object property). We cannot reassign the BLUE(2) <code>special</code> parameter to a different value from inside <code>keepLooking()</code>.</p><p>Another &quot;But...!?&quot; you may be about to raise: what if I&#39;d used objects or arrays as the values instead of the numbers (<code>112358132134</code>, etc.)? Would us having references to objects instead of copies of primitive values &quot;fix&quot; the inaccessibility?</p><p>No. Mutating the contents of the object value via a reference copy is <strong>not</strong> the same thing as lexically accessing the variable itself. We still can&#39;t reassign the BLUE(2) <code>special</code> parameter.</p><h3 id="illegal-shadowing" tabindex="-1"><a class="header-anchor" href="#illegal-shadowing" aria-hidden="true">#</a> Illegal Shadowing</h3><p>Not all combinations of declaration shadowing are allowed. <code>let</code> can shadow <code>var</code>, but <code>var</code> cannot shadow <code>let</code>:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">something</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> special <span class="token operator">=</span> <span class="token string">&quot;JavaScript&quot;</span><span class="token punctuation">;</span>

    <span class="token punctuation">{</span>
        <span class="token keyword">let</span> special <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>   <span class="token comment">// totally fine shadowing</span>

        <span class="token comment">// ..</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">another</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ..</span>

    <span class="token punctuation">{</span>
        <span class="token keyword">let</span> special <span class="token operator">=</span> <span class="token string">&quot;JavaScript&quot;</span><span class="token punctuation">;</span>

        <span class="token punctuation">{</span>
            <span class="token keyword">var</span> special <span class="token operator">=</span> <span class="token string">&quot;JavaScript&quot;</span><span class="token punctuation">;</span>
            <span class="token comment">// ^^^ Syntax Error</span>

            <span class="token comment">// ..</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>Notice in the <code>another()</code> function, the inner <code>var special</code> declaration is attempting to declare a function-wide <code>special</code>, which in and of itself is fine (as shown by the <code>something()</code> function).</p><p>The syntax error description in this case indicates that <code>special</code> has already been defined, but that error message is a little misleading—again, no such error happens in <code>something()</code>, as shadowing is generally allowed just fine.</p><p>The real reason it&#39;s raised as a <code>SyntaxError</code> is because the <code>var</code> is basically trying to &quot;cross the boundary&quot; of (or hop over) the <code>let</code> declaration of the same name, which is not allowed.</p><p>That boundary-crossing prohibition effectively stops at each function boundary, so this variant raises no exception:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">another</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ..</span>

    <span class="token punctuation">{</span>
        <span class="token keyword">let</span> special <span class="token operator">=</span> <span class="token string">&quot;JavaScript&quot;</span><span class="token punctuation">;</span>

        <span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">&quot;https://some.url&quot;</span><span class="token punctuation">,</span><span class="token keyword">function</span> <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">// totally fine shadowing</span>
            <span class="token keyword">var</span> special <span class="token operator">=</span> <span class="token string">&quot;JavaScript&quot;</span><span class="token punctuation">;</span>

            <span class="token comment">// ..</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>Summary: <code>let</code> (in an inner scope) can always shadow an outer scope&#39;s <code>var</code>. <code>var</code> (in an inner scope) can only shadow an outer scope&#39;s <code>let</code> if there is a function boundary in between.</p><h2 id="function-name-scope" tabindex="-1"><a class="header-anchor" href="#function-name-scope" aria-hidden="true">#</a> Function Name Scope</h2><p>As you&#39;ve seen by now, a <code>function</code> declaration looks like this:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">askQuestion</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ..</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>And as discussed in Chapters 1 and 2, such a <code>function</code> declaration will create an identifier in the enclosing scope (in this case, the global scope) named <code>askQuestion</code>.</p><p>What about this program?</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token function-variable function">askQuestion</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// ..</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>The same is true for the variable <code>askQuestion</code> being created. But since it&#39;s a <code>function</code> expression—a function definition used as value instead of a standalone declaration—the function itself will not &quot;hoist&quot; (see Chapter 5).</p><p>One major difference between <code>function</code> declarations and <code>function</code> expressions is what happens to the name identifier of the function. Consider a named <code>function</code> expression:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token function-variable function">askQuestion</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">ofTheTeacher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// ..</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>We know <code>askQuestion</code> ends up in the outer scope. But what about the <code>ofTheTeacher</code> identifier? For formal <code>function</code> declarations, the name identifier ends up in the outer/enclosing scope, so it may be reasonable to assume that&#39;s the case here. But <code>ofTheTeacher</code> is declared as an identifier <strong>inside the function itself</strong>:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token function-variable function">askQuestion</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">ofTheTeacher</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ofTheTeacher<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">askQuestion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// function ofTheTeacher()...</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ofTheTeacher<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ReferenceError: ofTheTeacher is not defined</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><table><thead><tr><th style="text-align:left;">NOTE:</th></tr></thead><tbody><tr><td style="text-align:left;">Actually, <code>ofTheTeacher</code> is not exactly <em>in the scope of the function</em>. Appendix A, &quot;Implied Scopes&quot; will explain further.</td></tr></tbody></table><p>Not only is <code>ofTheTeacher</code> declared inside the function rather than outside, but it&#39;s also defined as read-only:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token function-variable function">askQuestion</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">ofTheTeacher</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;use strict&quot;</span><span class="token punctuation">;</span>
    ofTheTeacher <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>   <span class="token comment">// TypeError</span>

    <span class="token comment">//..</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">askQuestion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// TypeError</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>Because we used strict-mode, the assignment failure is reported as a <code>TypeError</code>; in non-strict-mode, such an assignment fails silently with no exception.</p><p>What about when a <code>function</code> expression has no name identifier?</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token function-variable function">askQuestion</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token comment">// ..</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>A <code>function</code> expression with a name identifier is referred to as a &quot;named function expression,&quot; but one without a name identifier is referred to as an &quot;anonymous function expression.&quot; Anonymous function expressions clearly have no name identifier that affects either scope.</p><table><thead><tr><th style="text-align:left;">NOTE:</th></tr></thead><tbody><tr><td style="text-align:left;">We&#39;ll discuss named vs. anonymous <code>function</code> expressions in much more detail, including what factors affect the decision to use one or the other, in Appendix A.</td></tr></tbody></table><h2 id="arrow-functions" tabindex="-1"><a class="header-anchor" href="#arrow-functions" aria-hidden="true">#</a> Arrow Functions</h2><p>ES6 added an additional <code>function</code> expression form to the language, called &quot;arrow functions&quot;:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token function-variable function">askQuestion</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// ..</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>The <code>=&gt;</code> arrow function doesn&#39;t require the word <code>function</code> to define it. Also, the <code>( .. )</code> around the parameter list is optional in some simple cases. Likewise, the <code>{ .. }</code> around the function body is optional in some cases. And when the <code>{ .. }</code> are omitted, a return value is sent out without using a <code>return</code> keyword.</p><table><thead><tr><th style="text-align:left;">NOTE:</th></tr></thead><tbody><tr><td style="text-align:left;">The attractiveness of <code>=&gt;</code> arrow functions is often sold as &quot;shorter syntax,&quot; and that&#39;s claimed to equate to objectively more readable code. This claim is dubious at best, and I believe outright misguided. We&#39;ll dig into the &quot;readability&quot; of various function forms in Appendix A.</td></tr></tbody></table><p>Arrow functions are lexically anonymous, meaning they have no directly related identifier that references the function. The assignment to <code>askQuestion</code> creates an inferred name of &quot;askQuestion&quot;, but that&#39;s <strong>not the same thing as being non-anonymous</strong>:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token function-variable function">askQuestion</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// ..</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

askQuestion<span class="token punctuation">.</span>name<span class="token punctuation">;</span>   <span class="token comment">// askQuestion</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Arrow functions achieve their syntactic brevity at the expense of having to mentally juggle a bunch of variations for different forms/conditions. Just a few, for example:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">42</span><span class="token punctuation">;</span>

<span class="token parameter">id</span> <span class="token operator">=&gt;</span> id<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">,</span>name</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> id<span class="token punctuation">,</span> name <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> args<span class="token punctuation">[</span>args<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>The real reason I bring up arrow functions is because of the common but incorrect claim that arrow functions somehow behave differently with respect to lexical scope from standard <code>function</code> functions.</p><p>This is incorrect.</p><p>Other than being anonymous (and having no declarative form), <code>=&gt;</code> arrow functions have the same lexical scope rules as <code>function</code> functions do. An arrow function, with or without <code>{ .. }</code> around its body, still creates a separate, inner nested bucket of scope. Variable declarations inside this nested scope bucket behave the same as in a <code>function</code> scope.</p><h2 id="backing-out" tabindex="-1"><a class="header-anchor" href="#backing-out" aria-hidden="true">#</a> Backing Out</h2><p>When a function (declaration or expression) is defined, a new scope is created. The positioning of scopes nested inside one another creates a natural scope hierarchy throughout the program, called the scope chain. The scope chain controls variable access, directionally oriented upward and outward.</p><p>Each new scope offers a clean slate, a space to hold its own set of variables. When a variable name is repeated at different levels of the scope chain, shadowing occurs, which prevents access to the outer variable from that point inward.</p><p>As we step back out from these finer details, the next chapter shifts focus to the primary scope all JS programs include: the global scope.</p><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/us-fe/ebooks/edit/master/docs/zh/you-dont-know-js-v2/scope-closures/ch3.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page"><!--[--><!--]--> Edit this page <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: yanqi.zyq@antfin.com">yanqi</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--[--><div class="giscus-wrapper input-top" style="display:block;"><giscus-widget repo="us-fe/ebooks" repoId="R_kgDOHQs-GA" category="Announcements" categoryId="DIC_kwDOHQs-GM4CO312" lang="zh-CN" theme="light" mapping="pathname" inputPosition="top" reactionsEnabled="1" emitMetadata="0"></giscus-widget></div><!--]--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/ebooks/assets/app.a957722f.js" defer></script>
  </body>
</html>
