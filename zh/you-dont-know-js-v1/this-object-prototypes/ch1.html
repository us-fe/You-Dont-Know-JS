<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.38">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <title>你不懂JS: this 与对象原型 | US-FE</title><meta name="description" content="US-FE eBoks">
    <link rel="modulepreload" href="/ebooks/assets/app.a957722f.js"><link rel="modulepreload" href="/ebooks/assets/ch1.html.546280ee.js"><link rel="modulepreload" href="/ebooks/assets/ch1.html.22bab4c5.js">
    <link rel="stylesheet" href="/ebooks/assets/style.6c500c23.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/ebooks/zh/" class=""><img class="logo" src="https://vuejs.org/images/logo.png" alt="US-FE"><span class="site-name can-hide">US-FE</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a class="external-link" href="https://us-fe.github.io" rel="noopener noreferrer" target="_blank" aria-label="US-FE"><!--[--><!--]--> US-FE <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a href="/ebooks/" class="router-link-active" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="You Don&#39;t Know JS"><span class="title">You Don&#39;t Know JS</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="You Don&#39;t Know JS"><span class="title">You Don&#39;t Know JS</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>V1</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/ebooks/zh/you-dont-know-js-v1/up-going/" class="" aria-label="Up &amp; Going"><!--[--><!--]--> Up &amp; Going <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ebooks/zh/you-dont-know-js-v1/scope-closures/" class="" aria-label="Scope &amp; Closures"><!--[--><!--]--> Scope &amp; Closures <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ebooks/zh/you-dont-know-js-v1/this-object-prototypes/" class="router-link-active" aria-label="This &amp; Object Prototypes"><!--[--><!--]--> This &amp; Object Prototypes <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ebooks/zh/you-dont-know-js-v1/types-grammar/" class="" aria-label="Types &amp; Grammar"><!--[--><!--]--> Types &amp; Grammar <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ebooks/zh/you-dont-know-js-v1/async-performance/" class="" aria-label="Async &amp; Performance"><!--[--><!--]--> Async &amp; Performance <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ebooks/zh/you-dont-know-js-v1/es6-beyond/" class="" aria-label="ES6 &amp; Beyond"><!--[--><!--]--> ES6 &amp; Beyond <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>V2</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/ebooks/zh/you-dont-know-js-v2/get-started/" class="" aria-label="Get Started"><!--[--><!--]--> Get Started <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ebooks/zh/you-dont-know-js-v2/scope-closures/" class="" aria-label="Scope &amp; Closures"><!--[--><!--]--> Scope &amp; Closures <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Professional Javascript for Web Developers V4"><span class="title">Professional Javascript for Web Developers V4</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Professional Javascript for Web Developers V4"><span class="title">Professional Javascript for Web Developers V4</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch1-what-is-javascript" class="" aria-label="Chapter 1: What Is JavaScript?"><!--[--><!--]--> Chapter 1: What Is JavaScript? <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch2-javascript-in-html" class="" aria-label="Chapter 2: JavaScript in HTML"><!--[--><!--]--> Chapter 2: JavaScript in HTML <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch3-language-basics" class="" aria-label="Chapter 3: Language Basics"><!--[--><!--]--> Chapter 3: Language Basics <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch4-variables-scope-and-memory" class="" aria-label="Chapter 4: Variables, Scope, and Memory"><!--[--><!--]--> Chapter 4: Variables, Scope, and Memory <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch5-basic-reference-types" class="" aria-label="Chapter 5: Basic Reference Types"><!--[--><!--]--> Chapter 5: Basic Reference Types <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch6-collection-reference-types" class="" aria-label="Chapter 6: Collection Reference Types"><!--[--><!--]--> Chapter 6: Collection Reference Types <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch7-iterators-and-generators" class="" aria-label="Chapter 7: Iterators and Generators"><!--[--><!--]--> Chapter 7: Iterators and Generators <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch8-objects-classes-and-object-oriented-programming" class="" aria-label="Chapter 8: Objects, Classes, and Object-Oriented Programming"><!--[--><!--]--> Chapter 8: Objects, Classes, and Object-Oriented Programming <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch9-proxies-and-reflect" class="" aria-label="Chapter 9: Proxies and Reflect"><!--[--><!--]--> Chapter 9: Proxies and Reflect <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch10-funtions" class="" aria-label="Chapter 10: Functions"><!--[--><!--]--> Chapter 10: Functions <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch11-promises-and-async-functions" class="" aria-label="Chapter 11: Promises and Async Functions"><!--[--><!--]--> Chapter 11: Promises and Async Functions <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch12-the-browser-object-model" class="" aria-label="Chapter 12: The Browser Object Model"><!--[--><!--]--> Chapter 12: The Browser Object Model <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch13-client-detection" class="" aria-label="Chapter 13: Client Detection"><!--[--><!--]--> Chapter 13: Client Detection <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch14-the-document-object-model" class="" aria-label="Chapter 14: The Document Object Model"><!--[--><!--]--> Chapter 14: The Document Object Model <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch15-dom-extensions" class="" aria-label="Chapter 15: DOM Extensions"><!--[--><!--]--> Chapter 15: DOM Extensions <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch16-dom-levels-2-and-3" class="" aria-label="Chapter 16: DOM Levels 2 and 3"><!--[--><!--]--> Chapter 16: DOM Levels 2 and 3 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch17-events" class="" aria-label="Chapter 17: Events"><!--[--><!--]--> Chapter 17: Events <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch18-animation-and-graphics-with-canvas" class="" aria-label="Chapter 18: Animation and Graphics with Canvas"><!--[--><!--]--> Chapter 18: Animation and Graphics with Canvas <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch19-scripting-forms" class="" aria-label="Chapter 19: Scripting Forms"><!--[--><!--]--> Chapter 19: Scripting Forms <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch20-javascript-apis" class="" aria-label="Chapter 20: JavaScript APIs"><!--[--><!--]--> Chapter 20: JavaScript APIs <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch21-error-handling-and-debugging" class="" aria-label="Chapter 21: Error Handling and Debugging"><!--[--><!--]--> Chapter 21: Error Handling and Debugging <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch22-xml-in-javascript" class="" aria-label="Chapter 22: XML in JavaScript"><!--[--><!--]--> Chapter 22: XML in JavaScript <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch23-json" class="" aria-label="Chapter 23: JSON"><!--[--><!--]--> Chapter 23: JSON <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch24-network-requests-and-remote-resources" class="" aria-label="Chapter 24: Network Requests and Remote Resources"><!--[--><!--]--> Chapter 24: Network Requests and Remote Resources <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch25-client-side-storage" class="" aria-label="Chapter 25: Client-Side Storage"><!--[--><!--]--> Chapter 25: Client-Side Storage <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch26-modules" class="" aria-label="Chapter 26: Modules"><!--[--><!--]--> Chapter 26: Modules <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch27-workers" class="" aria-label="Chapter 27: Workers"><!--[--><!--]--> Chapter 27: Workers <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch28-best-practices" class="" aria-label="Chapter 28: Best Practices"><!--[--><!--]--> Chapter 28: Best Practices <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/apA-es2018-and-es2019" class="" aria-label="Appendix A: ES2018 and ES2019"><!--[--><!--]--> Appendix A: ES2018 and ES2019 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/apB-strct-mode" class="" aria-label="Appendix B: Strict Mode"><!--[--><!--]--> Appendix B: Strict Mode <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/apC-javascript-libraries-and-frameworks" class="" aria-label="Appendix C: JavaScript Libraries and Frameworks"><!--[--><!--]--> Appendix C: JavaScript Libraries and Frameworks <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/apD-javascript-tools" class="" aria-label="Appendix D: JavasScript Tools"><!--[--><!--]--> Appendix D: JavasScript Tools <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">Languages</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a aria-current="page" href="/ebooks/zh/you-dont-know-js-v1/this-object-prototypes/ch1.html" class="router-link-active router-link-exact-active router-link-active" aria-label="简体中文"><!--[--><!--]--> 简体中文 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/you-dont-know-js-v1/this-object-prototypes/ch1.html" class="" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/us-fe/ebooks" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a class="external-link" href="https://us-fe.github.io" rel="noopener noreferrer" target="_blank" aria-label="US-FE"><!--[--><!--]--> US-FE <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a href="/ebooks/" class="router-link-active" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="You Don&#39;t Know JS"><span class="title">You Don&#39;t Know JS</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="You Don&#39;t Know JS"><span class="title">You Don&#39;t Know JS</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>V1</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/ebooks/zh/you-dont-know-js-v1/up-going/" class="" aria-label="Up &amp; Going"><!--[--><!--]--> Up &amp; Going <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ebooks/zh/you-dont-know-js-v1/scope-closures/" class="" aria-label="Scope &amp; Closures"><!--[--><!--]--> Scope &amp; Closures <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ebooks/zh/you-dont-know-js-v1/this-object-prototypes/" class="router-link-active" aria-label="This &amp; Object Prototypes"><!--[--><!--]--> This &amp; Object Prototypes <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ebooks/zh/you-dont-know-js-v1/types-grammar/" class="" aria-label="Types &amp; Grammar"><!--[--><!--]--> Types &amp; Grammar <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ebooks/zh/you-dont-know-js-v1/async-performance/" class="" aria-label="Async &amp; Performance"><!--[--><!--]--> Async &amp; Performance <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ebooks/zh/you-dont-know-js-v1/es6-beyond/" class="" aria-label="ES6 &amp; Beyond"><!--[--><!--]--> ES6 &amp; Beyond <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>V2</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/ebooks/zh/you-dont-know-js-v2/get-started/" class="" aria-label="Get Started"><!--[--><!--]--> Get Started <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ebooks/zh/you-dont-know-js-v2/scope-closures/" class="" aria-label="Scope &amp; Closures"><!--[--><!--]--> Scope &amp; Closures <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Professional Javascript for Web Developers V4"><span class="title">Professional Javascript for Web Developers V4</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Professional Javascript for Web Developers V4"><span class="title">Professional Javascript for Web Developers V4</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch1-what-is-javascript" class="" aria-label="Chapter 1: What Is JavaScript?"><!--[--><!--]--> Chapter 1: What Is JavaScript? <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch2-javascript-in-html" class="" aria-label="Chapter 2: JavaScript in HTML"><!--[--><!--]--> Chapter 2: JavaScript in HTML <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch3-language-basics" class="" aria-label="Chapter 3: Language Basics"><!--[--><!--]--> Chapter 3: Language Basics <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch4-variables-scope-and-memory" class="" aria-label="Chapter 4: Variables, Scope, and Memory"><!--[--><!--]--> Chapter 4: Variables, Scope, and Memory <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch5-basic-reference-types" class="" aria-label="Chapter 5: Basic Reference Types"><!--[--><!--]--> Chapter 5: Basic Reference Types <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch6-collection-reference-types" class="" aria-label="Chapter 6: Collection Reference Types"><!--[--><!--]--> Chapter 6: Collection Reference Types <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch7-iterators-and-generators" class="" aria-label="Chapter 7: Iterators and Generators"><!--[--><!--]--> Chapter 7: Iterators and Generators <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch8-objects-classes-and-object-oriented-programming" class="" aria-label="Chapter 8: Objects, Classes, and Object-Oriented Programming"><!--[--><!--]--> Chapter 8: Objects, Classes, and Object-Oriented Programming <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch9-proxies-and-reflect" class="" aria-label="Chapter 9: Proxies and Reflect"><!--[--><!--]--> Chapter 9: Proxies and Reflect <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch10-funtions" class="" aria-label="Chapter 10: Functions"><!--[--><!--]--> Chapter 10: Functions <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch11-promises-and-async-functions" class="" aria-label="Chapter 11: Promises and Async Functions"><!--[--><!--]--> Chapter 11: Promises and Async Functions <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch12-the-browser-object-model" class="" aria-label="Chapter 12: The Browser Object Model"><!--[--><!--]--> Chapter 12: The Browser Object Model <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch13-client-detection" class="" aria-label="Chapter 13: Client Detection"><!--[--><!--]--> Chapter 13: Client Detection <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch14-the-document-object-model" class="" aria-label="Chapter 14: The Document Object Model"><!--[--><!--]--> Chapter 14: The Document Object Model <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch15-dom-extensions" class="" aria-label="Chapter 15: DOM Extensions"><!--[--><!--]--> Chapter 15: DOM Extensions <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch16-dom-levels-2-and-3" class="" aria-label="Chapter 16: DOM Levels 2 and 3"><!--[--><!--]--> Chapter 16: DOM Levels 2 and 3 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch17-events" class="" aria-label="Chapter 17: Events"><!--[--><!--]--> Chapter 17: Events <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch18-animation-and-graphics-with-canvas" class="" aria-label="Chapter 18: Animation and Graphics with Canvas"><!--[--><!--]--> Chapter 18: Animation and Graphics with Canvas <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch19-scripting-forms" class="" aria-label="Chapter 19: Scripting Forms"><!--[--><!--]--> Chapter 19: Scripting Forms <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch20-javascript-apis" class="" aria-label="Chapter 20: JavaScript APIs"><!--[--><!--]--> Chapter 20: JavaScript APIs <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch21-error-handling-and-debugging" class="" aria-label="Chapter 21: Error Handling and Debugging"><!--[--><!--]--> Chapter 21: Error Handling and Debugging <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch22-xml-in-javascript" class="" aria-label="Chapter 22: XML in JavaScript"><!--[--><!--]--> Chapter 22: XML in JavaScript <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch23-json" class="" aria-label="Chapter 23: JSON"><!--[--><!--]--> Chapter 23: JSON <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch24-network-requests-and-remote-resources" class="" aria-label="Chapter 24: Network Requests and Remote Resources"><!--[--><!--]--> Chapter 24: Network Requests and Remote Resources <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch25-client-side-storage" class="" aria-label="Chapter 25: Client-Side Storage"><!--[--><!--]--> Chapter 25: Client-Side Storage <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch26-modules" class="" aria-label="Chapter 26: Modules"><!--[--><!--]--> Chapter 26: Modules <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch27-workers" class="" aria-label="Chapter 27: Workers"><!--[--><!--]--> Chapter 27: Workers <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/ch28-best-practices" class="" aria-label="Chapter 28: Best Practices"><!--[--><!--]--> Chapter 28: Best Practices <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/apA-es2018-and-es2019" class="" aria-label="Appendix A: ES2018 and ES2019"><!--[--><!--]--> Appendix A: ES2018 and ES2019 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/apB-strct-mode" class="" aria-label="Appendix B: Strict Mode"><!--[--><!--]--> Appendix B: Strict Mode <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/apC-javascript-libraries-and-frameworks" class="" aria-label="Appendix C: JavaScript Libraries and Frameworks"><!--[--><!--]--> Appendix C: JavaScript Libraries and Frameworks <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/zh/professional-javascript-for-web-developers-v4/apD-javascript-tools" class="" aria-label="Appendix D: JavasScript Tools"><!--[--><!--]--> Appendix D: JavasScript Tools <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">Languages</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a aria-current="page" href="/ebooks/zh/you-dont-know-js-v1/this-object-prototypes/ch1.html" class="router-link-active router-link-exact-active router-link-active" aria-label="简体中文"><!--[--><!--]--> 简体中文 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/you-dont-know-js-v1/this-object-prototypes/ch1.html" class="" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/us-fe/ebooks" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">Up &amp; Going <span class="right arrow"></span></p><!--[--><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/ebooks/zh/you-dont-know-js-v1/up-going/" class="sidebar-item" aria-label="README"><!--[--><!--]--> README <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/up-going/ch1" class="sidebar-item" aria-label="Chapter 1: Into Programming"><!--[--><!--]--> Chapter 1: Into Programming <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/up-going/ch2" class="sidebar-item" aria-label="Chapter 2: Into JavaScript"><!--[--><!--]--> Chapter 2: Into JavaScript <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/up-going/ch3" class="sidebar-item" aria-label="Chapter 3: Into YDKJS"><!--[--><!--]--> Chapter 3: Into YDKJS <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/up-going/apA" class="sidebar-item" aria-label="Appendix A: Acknowledgments"><!--[--><!--]--> Appendix A: Acknowledgments <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">Scope &amp; Closures <span class="right arrow"></span></p><!--[--><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/ebooks/zh/you-dont-know-js-v1/scope-closures/" class="sidebar-item" aria-label="README"><!--[--><!--]--> README <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/scope-closures/toc" class="sidebar-item" aria-label="TOC"><!--[--><!--]--> TOC <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/scope-closures/ch1" class="sidebar-item" aria-label="Chapter 1: What is Scope?"><!--[--><!--]--> Chapter 1: What is Scope? <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/scope-closures/ch2" class="sidebar-item" aria-label="Chapter 2: Lexical Scope"><!--[--><!--]--> Chapter 2: Lexical Scope <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/scope-closures/ch3" class="sidebar-item" aria-label="Chapter 3: Function vs. Block Scope"><!--[--><!--]--> Chapter 3: Function vs. Block Scope <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/scope-closures/ch4" class="sidebar-item" aria-label="Chapter 4: Hoisting"><!--[--><!--]--> Chapter 4: Hoisting <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/scope-closures/ch5" class="sidebar-item" aria-label="Chapter 5: Scope Closure"><!--[--><!--]--> Chapter 5: Scope Closure <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/scope-closures/apA" class="sidebar-item" aria-label="Appendix A: Dynamic Scope"><!--[--><!--]--> Appendix A: Dynamic Scope <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/scope-closures/apB" class="sidebar-item" aria-label="Appendix B: Polyfilling Block Scope"><!--[--><!--]--> Appendix B: Polyfilling Block Scope <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/scope-closures/apC" class="sidebar-item" aria-label="Appendix C: Lexical-this"><!--[--><!--]--> Appendix C: Lexical-this <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/scope-closures/apD" class="sidebar-item" aria-label="Appendix D: Acknowledgments"><!--[--><!--]--> Appendix D: Acknowledgments <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><p tabindex="0" class="sidebar-item sidebar-heading active collapsible">This &amp; Object Prototypes <span class="down arrow"></span></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a href="/ebooks/zh/you-dont-know-js-v1/this-object-prototypes/" class="router-link-active sidebar-item" aria-label="README"><!--[--><!--]--> README <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/this-object-prototypes/toc" class="sidebar-item" aria-label="TOC"><!--[--><!--]--> TOC <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/this-object-prototypes/ch1" class="router-link-active sidebar-item active" aria-label="Chapter 1: `this` Or That?"><!--[--><!--]--> Chapter 1: `this` Or That? <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/this-object-prototypes/ch2" class="sidebar-item" aria-label="Chapter 2: `this` All Makes Sense Now!"><!--[--><!--]--> Chapter 2: `this` All Makes Sense Now! <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/this-object-prototypes/ch3" class="sidebar-item" aria-label="Chapter 3: Objects"><!--[--><!--]--> Chapter 3: Objects <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/this-object-prototypes/ch4" class="sidebar-item" aria-label="Chapter 4: Mixing (Up) &quot;Class&quot; Objects"><!--[--><!--]--> Chapter 4: Mixing (Up) &quot;Class&quot; Objects <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/this-object-prototypes/ch5" class="sidebar-item" aria-label="Chapter 5: Prototypes"><!--[--><!--]--> Chapter 5: Prototypes <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/this-object-prototypes/ch3" class="sidebar-item" aria-label="Chapter 6: Behavior Delegation"><!--[--><!--]--> Chapter 6: Behavior Delegation <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/this-object-prototypes/apA" class="sidebar-item" aria-label="Appendix A: Acknowledgments"><!--[--><!--]--> Appendix A: Acknowledgments <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/this-object-prototypes/apB" class="sidebar-item" aria-label="Appendix A: Acknowledgments"><!--[--><!--]--> Appendix A: Acknowledgments <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">Types &amp; Grammar <span class="right arrow"></span></p><!--[--><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/ebooks/zh/you-dont-know-js-v1/types-grammar/" class="sidebar-item" aria-label="README"><!--[--><!--]--> README <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/types-grammar/toc" class="sidebar-item" aria-label="TOC"><!--[--><!--]--> TOC <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/types-grammar/ch1" class="sidebar-item" aria-label="Chapter 1: Types"><!--[--><!--]--> Chapter 1: Types <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/types-grammar/ch2" class="sidebar-item" aria-label="Chapter 2: Values"><!--[--><!--]--> Chapter 2: Values <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/types-grammar/ch3" class="sidebar-item" aria-label="Chapter 3: Natives"><!--[--><!--]--> Chapter 3: Natives <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/types-grammar/ch4" class="sidebar-item" aria-label="Chapter 4: Coercion"><!--[--><!--]--> Chapter 4: Coercion <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/types-grammar/ch5" class="sidebar-item" aria-label="Chapter 5: Grammar"><!--[--><!--]--> Chapter 5: Grammar <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/types-grammar/apA" class="sidebar-item" aria-label="Appendix A: Mixed Environment JavaScript"><!--[--><!--]--> Appendix A: Mixed Environment JavaScript <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">Async &amp; Performance <span class="right arrow"></span></p><!--[--><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/ebooks/zh/you-dont-know-js-v1/async-performance/" class="sidebar-item" aria-label="README"><!--[--><!--]--> README <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/async-performance/toc" class="sidebar-item" aria-label="TOC"><!--[--><!--]--> TOC <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/async-performance/ch1" class="sidebar-item" aria-label="Chapter 1: Asynchrony: Now &amp; Later"><!--[--><!--]--> Chapter 1: Asynchrony: Now &amp; Later <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/async-performance/ch2" class="sidebar-item" aria-label="Chapter 2: Callbacks"><!--[--><!--]--> Chapter 2: Callbacks <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/async-performance/ch3" class="sidebar-item" aria-label="Chapter 3: Promises"><!--[--><!--]--> Chapter 3: Promises <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/async-performance/ch4" class="sidebar-item" aria-label="Chapter 4: Generators"><!--[--><!--]--> Chapter 4: Generators <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/async-performance/ch5" class="sidebar-item" aria-label="Chapter 5: Program Performance"><!--[--><!--]--> Chapter 5: Program Performance <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/async-performance/ch6" class="sidebar-item" aria-label="Chapter 6: Benchmarking &amp; Tuning"><!--[--><!--]--> Chapter 6: Benchmarking &amp; Tuning <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/async-performance/apA" class="sidebar-item" aria-label="Appendix A: *asynquence* Library"><!--[--><!--]--> Appendix A: *asynquence* Library <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">ES6 &amp; Beyond <span class="right arrow"></span></p><!--[--><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/ebooks/zh/you-dont-know-js-v1/es6-beyond/" class="sidebar-item" aria-label="README"><!--[--><!--]--> README <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/es6-beyond/toc" class="sidebar-item" aria-label="TOC"><!--[--><!--]--> TOC <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/es6-beyond/ch1" class="sidebar-item" aria-label="Chapter 1: ES? Now &amp; Future"><!--[--><!--]--> Chapter 1: ES? Now &amp; Future <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/es6-beyond/ch2" class="sidebar-item" aria-label="Chapter 2: Syntax"><!--[--><!--]--> Chapter 2: Syntax <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/es6-beyond/ch3" class="sidebar-item" aria-label="Chapter 3: Organization"><!--[--><!--]--> Chapter 3: Organization <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/es6-beyond/ch4" class="sidebar-item" aria-label="Chapter 4: Async Flow Control"><!--[--><!--]--> Chapter 4: Async Flow Control <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/es6-beyond/ch5" class="sidebar-item" aria-label="Chapter 5: Collections"><!--[--><!--]--> Chapter 5: Collections <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/es6-beyond/ch6" class="sidebar-item" aria-label="Chapter 6: API Additions"><!--[--><!--]--> Chapter 6: API Additions <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/es6-beyond/ch7" class="sidebar-item" aria-label="Chapter 7: Meta Programming"><!--[--><!--]--> Chapter 7: Meta Programming <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/es6-beyond/ch8" class="sidebar-item" aria-label="Chapter 8: Beyond ES6"><!--[--><!--]--> Chapter 8: Beyond ES6 <!--[--><!--]--></a><!----></li><li><a href="/ebooks/zh/you-dont-know-js-v1/es6-beyond/apA" class="sidebar-item" aria-label="Appendix A: Acknowledgments"><!--[--><!--]--> Appendix A: Acknowledgments <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="你不懂js-this-与对象原型" tabindex="-1"><a class="header-anchor" href="#你不懂js-this-与对象原型" aria-hidden="true">#</a> 你不懂JS: <em>this</em> 与对象原型</h1><h1 id="第一章-this-是什么" tabindex="-1"><a class="header-anchor" href="#第一章-this-是什么" aria-hidden="true">#</a> 第一章: <code>this</code> 是什么？</h1><p>JavaScript 中最令人困惑的机制之一就是 <code>this</code> 关键字。它是一个在每个函数作用域中自动定义的特殊标识符关键字，但即便是一些老练的 JavaScript 开发者也对它到底指向什么感到困扰。</p><blockquote><p>任何足够 <em>先进</em> 的技术都跟魔法没有区别。-- Arthur C. Clarke</p></blockquote><p>JavaScript 的 <code>this</code> 机制实际上没有 <em>那么</em> 先进，但是开发者们总是在大脑中插入“复杂”和“混乱”来解释这句话，毫无疑问，如果没有清晰的理解，在 <em>你的</em> 困惑中 <code>this</code> 可能看起来就是彻头彻尾的魔法。</p><p><strong>注意：</strong> “this”这个词是在一般的论述中极常用的代词。所以，特别是在口头论述中，很难确定我们是在将“this”作为一个代词使用，还是在将它作为一个实际的关键字标识符使用。为了表意清晰，我会总是使用 <code>this</code> 来代表特殊的关键字，而在其他情况下使用“this”或 <em>this</em> 或 this。</p><h2 id="为什么要用-this" tabindex="-1"><a class="header-anchor" href="#为什么要用-this" aria-hidden="true">#</a> 为什么要用 <code>this</code>？</h2><p>如果对于那些老练的 JavaScript 开发者来说 <code>this</code> 机制都是如此的令人费解，那么有人会问为什么这种机制会有用？它带来的麻烦不是比好处多吗？在讲解 <em>如何</em> 有用之前，我们应当先来看看 <em>为什么</em> 有用。</p><p>让我们试着展示一下 <code>this</code> 的动机和用途：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">identify</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> greeting <span class="token operator">=</span> <span class="token string">&quot;Hello, I&#39;m &quot;</span> <span class="token operator">+</span> <span class="token function">identify</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span> <span class="token keyword">this</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> greeting <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> me <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Kyle&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> you <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Reader&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">identify</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span> me <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// KYLE</span>
<span class="token function">identify</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span> you <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// READER</span>

<span class="token function">speak</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span> me <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Hello, I&#39;m KYLE</span>
<span class="token function">speak</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span> you <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Hello, I&#39;m READER</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>如果这个代码段 <em>如何</em> 工作让你困惑，不要担心！我们很快就会讲解它。只是简要地将这些问题放在旁边，以便于我们可以更清晰的探究 <em>为什么</em>。</p><p>这个代码片段允许 <code>identify()</code> 和 <code>speak()</code> 函数对多个 <em>环境</em> 对象（<code>me</code> 和 <code>you</code>）进行复用，而不是针对每个对象定义函数的分离版本。</p><p>与使用 <code>this</code> 相反地，你可以明确地将环境对象传递给 <code>identify()</code> 和 <code>speak()</code>。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">identify</span><span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> context<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">speak</span><span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> greeting <span class="token operator">=</span> <span class="token string">&quot;Hello, I&#39;m &quot;</span> <span class="token operator">+</span> <span class="token function">identify</span><span class="token punctuation">(</span> context <span class="token punctuation">)</span><span class="token punctuation">;</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> greeting <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">identify</span><span class="token punctuation">(</span> you <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// READER</span>
<span class="token function">speak</span><span class="token punctuation">(</span> me <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Hello, I&#39;m KYLE</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>然而，<code>this</code> 机制提供了更优雅的方式来隐含地“传递”一个对象引用，导致更加干净的API设计和更容易的复用。</p><p>你的使用模式越复杂，你就会越清晰地看到：将执行环境作为一个明确参数传递，通常比传递 <code>this</code> 执行环境要乱。当我们探索对象和原型时，你将会看到一组可以自动引用恰当执行环境对象的函数是多么有用。</p><h2 id="困惑" tabindex="-1"><a class="header-anchor" href="#困惑" aria-hidden="true">#</a> 困惑</h2><p>我们很快就要开始讲解 <code>this</code> 是如何 <em>实际</em> 工作的，但我们首先要摒弃一些误解——它实际上 <em>不是</em> 如何工作的。</p><p>在开发者们用太过于字面的方式考虑“this”这个名字时就会产生困惑。这通常会产生两种臆测，但都是不对的。</p><h3 id="它自己" tabindex="-1"><a class="header-anchor" href="#它自己" aria-hidden="true">#</a> 它自己</h3><p>第一种常见的倾向是认为 <code>this</code> 指向函数自己。至少，这是一种语法上的合理推测。</p><p>为什么你想要在函数内部引用它自己？最常见的理由是递归（在函数内部调用它自己）这样的情形，或者是一个在第一次被调用时会解除自己绑定的事件处理器。</p><p>初次接触 JS 机制的开发者们通常认为，将函数作为一个对象（JavaScript 中所有的函数都是对象！），可以让你在方法调用之间储存 <em>状态</em>（属性中的值）。这当然是可能的，而且有一些有限的用处，但这本书的其余部分将会阐述许多其他的模式，提供比函数对象 <em>更好</em> 的地方来存储状态。</p><p>过一会儿我们将探索一个模式，来展示 <code>this</code> 是如何不让一个函数像我们可能假设的那样，得到它自身的引用的。</p><p>考虑下面的代码，我们试图追踪函数(<code>foo</code>)被调用了多少次：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">&quot;foo: &quot;</span> <span class="token operator">+</span> num <span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// 追踪 `foo` 被调用了多少次</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>count<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

foo<span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> i<span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">foo</span><span class="token punctuation">(</span> i <span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// foo: 6</span>
<span class="token comment">// foo: 7</span>
<span class="token comment">// foo: 8</span>
<span class="token comment">// foo: 9</span>

<span class="token comment">// `foo` 被调用了多少次？</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> foo<span class="token punctuation">.</span>count <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0 -- 这他妈怎么回事……？</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p><code>foo.count</code> <em>依然</em> 是 <code>0</code>, 即便四个 <code>console.log</code> 语句明明告诉我们 <code>foo(..)</code> 实际上被调用了四次。这种挫败来源于对于 <code>this</code>（在 <code>this.count++</code> 中）的含义进行了 <em>过于字面化</em> 的解释。</p><p>当代码执行 <code>foo.count = 0</code> 时，它确实向函数对象 <code>foo</code> 添加了一个 <code>count</code> 属性。但是对于函数内部的 <code>this.count</code> 引用，<code>this</code> 其实 <em>根本就不</em> 指向那个函数对象，即便属性名称一样，但根对象也不同，因而产生了混淆。</p><p><strong>注意：</strong> 一个负责任的开发者 <em>应当</em> 在这里提出一个问题：“如果我递增的 <code>count</code> 属性不是我以为的那个，那是哪个 <code>count</code> 被我递增了？”。实际上，如果他再挖的深一些，他会发现自己不小心创建了一个全局变量 <code>count</code>（第二章解释了这是 <em>如何</em> 发生的！），而且它当前的值是 <code>NaN</code>。当然，一旦他发现这个不寻常的结果后，他会有一堆其他的问题：“它怎么是全局的？为什么它是 <code>NaN</code> 而不是某个正确的计数值？”。（见第二章）</p><p>与停在这里来深究为什么 <code>this</code> 引用看起来不是如我们 <em>期待</em> 的那样工作，并且回答那些尖锐且重要的问题相反，许多开发者简单地完全回避这个问题，转向一些其他的另类解决方法，比如创建另一个对象来持有 <code>count</code> 属性：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">&quot;foo: &quot;</span> <span class="token operator">+</span> num <span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// 追踪 `foo` 被调用了多少次</span>
	data<span class="token punctuation">.</span>count<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> i<span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">foo</span><span class="token punctuation">(</span> i <span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// foo: 6</span>
<span class="token comment">// foo: 7</span>
<span class="token comment">// foo: 8</span>
<span class="token comment">// foo: 9</span>

<span class="token comment">// `foo` 被调用了多少次？</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> data<span class="token punctuation">.</span>count <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 4</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>虽然这种方式“解决”了问题是事实，但不幸的是它简单地忽略了真正的问题 —— 缺乏对于 <code>this</code> 的含义和其工作方式上的理解 —— 反而退回到了一个他更加熟悉的机制的舒适区：词法作用域。</p><p><strong>注意：</strong> 词法作用域是一个完善且有用的机制；我不是在用任何方式贬低它的作用（参见本系列的 <em>&quot;作用域与闭包&quot;</em>）。但在如何使用 <code>this</code> 这个问题上总是靠 <em>猜</em>，而且通常都猜 <em>错</em>，并不是一个退回到词法作用域，而且从不学习 <em>为什么</em> <code>this</code> 不跟你合作的好理由。</p><p>为了从函数对象内部引用它自己，一般来说通过 <code>this</code> 是不够的。你通常需要通过一个指向它的词法标识符（变量）得到函数对象的引用。</p><p>考虑这两个函数：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	foo<span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">// `foo` 引用它自己</span>
<span class="token punctuation">}</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// 匿名函数（没有名字）不能引用它自己</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">10</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>第一个函数，称为“命名函数”，<code>foo</code> 是一个引用，可以用于在它内部引用自己。</p><p>但是在第二个例子中，传递给 <code>setTimeout(..)</code> 的回调函数没有名称标识符（所以被称为“匿名函数”），所以没有合适的办法引用函数对象自己。</p><p><strong>注意：</strong> 在函数中有一个老牌儿但是现在被废弃的，而且令人皱眉头的 <code>arguments.callee</code> 引用 <em>也</em> 指向当前正在执行的函数的函数对象。这个引用通常是匿名函数在自己内部访问函数对象的唯一方法。然而，最佳的办法是完全避免使用匿名函数，至少是对于那些需要自引用的函数，而使用命名函数（表达式）。<code>arguments.callee</code> 已经被废弃而且不应该再使用。</p><p>对于当前我们的例子来说，另一个 <em>好用的</em> 解决方案是在每一个地方都使用 <code>foo</code> 标识符作为函数对象的引用，而根本不用<code>this</code>：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">&quot;foo: &quot;</span> <span class="token operator">+</span> num <span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// 追踪 `foo` 被调用了多少次</span>
	foo<span class="token punctuation">.</span>count<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

foo<span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> i<span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">foo</span><span class="token punctuation">(</span> i <span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// foo: 6</span>
<span class="token comment">// foo: 7</span>
<span class="token comment">// foo: 8</span>
<span class="token comment">// foo: 9</span>

<span class="token comment">// `foo` 被调用了多少次？</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> foo<span class="token punctuation">.</span>count <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 4</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>然而，这种方法也类似地回避了对 <code>this</code> 的 <em>真正</em> 理解，而且完全依靠变量 <code>foo</code> 的词法作用域。</p><p>另一种解决这个问题的方法是强迫 <code>this</code> 指向 <code>foo</code> 函数对象：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">&quot;foo: &quot;</span> <span class="token operator">+</span> num <span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// 追踪 `foo` 被调用了多少次</span>
	<span class="token comment">// 注意：由于 `foo` 的被调用方式（见下方），`this` 现在确实是 `foo`</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>count<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

foo<span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> i<span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// 使用 `call(..)`，我们可以保证 `this` 指向函数对象(`foo`)</span>
		<span class="token function">foo</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span> foo<span class="token punctuation">,</span> i <span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// foo: 6</span>
<span class="token comment">// foo: 7</span>
<span class="token comment">// foo: 8</span>
<span class="token comment">// foo: 9</span>

<span class="token comment">// `foo` 被调用了多少次？</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> foo<span class="token punctuation">.</span>count <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 4</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p><strong>与回避 <code>this</code> 相反，我们接受它。</strong> 我们马上将会更完整地讲解这样的技术 <em>如何</em> 工作，所以如果你依然有点儿糊涂，不要担心！</p><h3 id="它的作用域" tabindex="-1"><a class="header-anchor" href="#它的作用域" aria-hidden="true">#</a> 它的作用域</h3><p>对 <code>this</code> 的含义第二常见的误解，是它不知怎的指向了函数的作用域。这是一个刁钻的问题，因为在某一种意义上它有正确的部分，而在另外一种意义上，它是严重的误导。</p><p>明确地说，<code>this</code> 不会以任何方式指向函数的 <strong>词法作用域</strong>。作用域好像是一个将所有可用标识符作为属性的对象，这从内部来说是对的。但是 JavasScript 代码不能访问作用域“对象”。它是 <em>引擎</em> 的内部实现。</p><p>考虑下面代码，它（失败的）企图跨越这个边界，用 <code>this</code> 来隐含地引用函数的词法作用域：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token keyword">this</span><span class="token punctuation">.</span>a <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//undefined</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>这个代码段里不只有一个错误。虽然它看起来是在故意瞎搞，但你看到的这段代码，提取自在公共社区的帮助论坛中被交换的真实代码。真是难以想象对 <code>this</code> 的臆想是多么的误导人。</p><p>首先，试图通过 <code>this.bar()</code> 来引用 <code>bar()</code> 函数。它几乎可以说是 <em>碰巧</em> 能够工作，我们过一会儿再解释它是 <em>如何</em> 工作的。调用 <code>bar()</code> 最自然的方式是省略开头的 <code>this.</code>，而仅使用标识符进行词法引用。</p><p>然而，写下这段代码的开发者试图用 <code>this</code> 在 <code>foo()</code> 和 <code>bar()</code> 的词法作用域间建立一座桥，使得<code>bar()</code> 可以访问 <code>foo()</code>内部作用域的变量 <code>a</code>。<strong>这样的桥是不可能的。</strong> 你不能使用 <code>this</code> 引用在词法作用域中查找东西。这是不可能的。</p><p>每当你感觉自己正在试图使用 <code>this</code> 来进行词法作用域的查询时，提醒你自己：<em>这里没有桥</em>。</p><h2 id="什么是-this" tabindex="-1"><a class="header-anchor" href="#什么是-this" aria-hidden="true">#</a> 什么是 <code>this</code>？</h2><p>我们已经列举了各种不正确的臆想，现在让我们把注意力转移到 <code>this</code> 机制是如何真正工作的。</p><p>我们早先说过，<code>this</code> 不是编写时绑定，而是运行时绑定。它依赖于函数调用的上下文条件。<code>this</code> 绑定与函数声明的位置没有任何关系，而与函数被调用的方式紧密相连。</p><p>当一个函数被调用时，会建立一个称为执行环境的活动记录。这个记录包含函数是从何处（调用栈 —— call-stack）被调用的，函数是 <em>如何</em> 被调用的，被传递了什么参数等信息。这个记录的属性之一，就是在函数执行期间将被使用的 <code>this</code> 引用。</p><p>下一章中，我们将会学习寻找函数的 <strong>调用点（call-site）</strong> 来判定它的执行如何绑定 <code>this</code>。</p><h2 id="复习" tabindex="-1"><a class="header-anchor" href="#复习" aria-hidden="true">#</a> 复习</h2><p>对于那些没有花时间学习 <code>this</code> 绑定机制如何工作的 JavaScript 开发者来说，<code>this</code> 绑定一直是困惑的根源。对于 <code>this</code> 这么重要的机制来说，猜测、试错、或者盲目地从 Stack Overflow 的回答中复制粘贴，都不是有效或正确利用它的方法。</p><p>为了学习 <code>this</code>，你必须首先学习 <code>this</code><em>不是</em> 什么，不论是哪种把你误导至何处的臆测或误解。<code>this</code> 既不是函数自身的引用，也不是函数 <em>词法</em> 作用域的引用。</p><p><code>this</code> 实际上是在函数被调用时建立的一个绑定，它指向 <em>什么</em> 是完全由函数被调用的调用点来决定的。</p><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/us-fe/ebooks/edit/master/docs/zh/you-dont-know-js-v1/this-object-prototypes/ch1.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page"><!--[--><!--]--> Edit this page <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: yanqi.zyq@antfin.com">yanqi</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--[--><div class="giscus-wrapper input-top" style="display:block;"><giscus-widget repo="us-fe/ebooks" repoId="R_kgDOHQs-GA" category="Announcements" categoryId="DIC_kwDOHQs-GM4CO312" lang="zh-CN" theme="light" mapping="pathname" inputPosition="top" reactionsEnabled="1" emitMetadata="0"></giscus-widget></div><!--]--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/ebooks/assets/app.a957722f.js" defer></script>
  </body>
</html>
