<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.38">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <title>You Don't Know JS: Scope & Closures | US-FE</title><meta name="description" content="US-FE eBoks">
    <link rel="modulepreload" href="/ebooks/assets/app.a957722f.js"><link rel="modulepreload" href="/ebooks/assets/ch2.html.6eec263b.js"><link rel="modulepreload" href="/ebooks/assets/ch2.html.8fe44bbd.js">
    <link rel="stylesheet" href="/ebooks/assets/style.6c500c23.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/ebooks/en/" class=""><img class="logo" src="https://vuejs.org/images/logo.png" alt="US-FE"><span class="site-name can-hide">US-FE</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a class="external-link" href="https://us-fe.github.io" rel="noopener noreferrer" target="_blank" aria-label="US-FE"><!--[--><!--]--> US-FE <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a href="/ebooks/" class="router-link-active" aria-label="Home"><!--[--><!--]--> Home <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="You Don&#39;t Know JS"><span class="title">You Don&#39;t Know JS</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="You Don&#39;t Know JS"><span class="title">You Don&#39;t Know JS</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>V1</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/ebooks/en/you-dont-know-js-v1/up-going/" class="" aria-label="Up &amp; Going"><!--[--><!--]--> Up &amp; Going <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ebooks/en/you-dont-know-js-v1/scope-closures/" class="router-link-active" aria-label="Scope &amp; Closures"><!--[--><!--]--> Scope &amp; Closures <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ebooks/en/you-dont-know-js-v1/this-object-prototypes/" class="" aria-label="This &amp; Object Prototypes"><!--[--><!--]--> This &amp; Object Prototypes <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ebooks/en/you-dont-know-js-v1/types-grammar/" class="" aria-label="Types &amp; Grammar"><!--[--><!--]--> Types &amp; Grammar <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ebooks/en/you-dont-know-js-v1/async-performance/" class="" aria-label="Async &amp; Performance"><!--[--><!--]--> Async &amp; Performance <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ebooks/en/you-dont-know-js-v1/es6-beyond/" class="" aria-label="ES6 &amp; Beyond"><!--[--><!--]--> ES6 &amp; Beyond <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>V2</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/ebooks/en/you-dont-know-js-v2/get-started/" class="" aria-label="Get Started"><!--[--><!--]--> Get Started <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ebooks/en/you-dont-know-js-v2/scope-closures/" class="" aria-label="Scope &amp; Closures"><!--[--><!--]--> Scope &amp; Closures <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Professional Javascript for Web Developers V4"><span class="title">Professional Javascript for Web Developers V4</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Professional Javascript for Web Developers V4"><span class="title">Professional Javascript for Web Developers V4</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch1-what-is-javascript" class="" aria-label="Chapter 1: What Is JavaScript?"><!--[--><!--]--> Chapter 1: What Is JavaScript? <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch2-javascript-in-html" class="" aria-label="Chapter 2: JavaScript in HTML"><!--[--><!--]--> Chapter 2: JavaScript in HTML <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch3-language-basics" class="" aria-label="Chapter 3: Language Basics"><!--[--><!--]--> Chapter 3: Language Basics <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch4-variables-scope-and-memory" class="" aria-label="Chapter 4: Variables, Scope, and Memory"><!--[--><!--]--> Chapter 4: Variables, Scope, and Memory <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch5-basic-reference-types" class="" aria-label="Chapter 5: Basic Reference Types"><!--[--><!--]--> Chapter 5: Basic Reference Types <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch6-collection-reference-types" class="" aria-label="Chapter 6: Collection Reference Types"><!--[--><!--]--> Chapter 6: Collection Reference Types <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch7-iterators-and-generators" class="" aria-label="Chapter 7: Iterators and Generators"><!--[--><!--]--> Chapter 7: Iterators and Generators <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch8-objects-classes-and-object-oriented-programming" class="" aria-label="Chapter 8: Objects, Classes, and Object-Oriented Programming"><!--[--><!--]--> Chapter 8: Objects, Classes, and Object-Oriented Programming <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch9-proxies-and-reflect" class="" aria-label="Chapter 9: Proxies and Reflect"><!--[--><!--]--> Chapter 9: Proxies and Reflect <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch10-funtions" class="" aria-label="Chapter 10: Functions"><!--[--><!--]--> Chapter 10: Functions <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch11-promises-and-async-functions" class="" aria-label="Chapter 11: Promises and Async Functions"><!--[--><!--]--> Chapter 11: Promises and Async Functions <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch12-the-browser-object-model" class="" aria-label="Chapter 12: The Browser Object Model"><!--[--><!--]--> Chapter 12: The Browser Object Model <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch13-client-detection" class="" aria-label="Chapter 13: Client Detection"><!--[--><!--]--> Chapter 13: Client Detection <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch14-the-document-object-model" class="" aria-label="Chapter 14: The Document Object Model"><!--[--><!--]--> Chapter 14: The Document Object Model <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch15-dom-extensions" class="" aria-label="Chapter 15: DOM Extensions"><!--[--><!--]--> Chapter 15: DOM Extensions <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch16-dom-levels-2-and-3" class="" aria-label="Chapter 16: DOM Levels 2 and 3"><!--[--><!--]--> Chapter 16: DOM Levels 2 and 3 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch17-events" class="" aria-label="Chapter 17: Events"><!--[--><!--]--> Chapter 17: Events <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch18-animation-and-graphics-with-canvas" class="" aria-label="Chapter 18: Animation and Graphics with Canvas"><!--[--><!--]--> Chapter 18: Animation and Graphics with Canvas <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch19-scripting-forms" class="" aria-label="Chapter 19: Scripting Forms"><!--[--><!--]--> Chapter 19: Scripting Forms <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch20-javascript-apis" class="" aria-label="Chapter 20: JavaScript APIs"><!--[--><!--]--> Chapter 20: JavaScript APIs <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch21-error-handling-and-debugging" class="" aria-label="Chapter 21: Error Handling and Debugging"><!--[--><!--]--> Chapter 21: Error Handling and Debugging <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch22-xml-in-javascript" class="" aria-label="Chapter 22: XML in JavaScript"><!--[--><!--]--> Chapter 22: XML in JavaScript <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch23-json" class="" aria-label="Chapter 23: JSON"><!--[--><!--]--> Chapter 23: JSON <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch24-network-requests-and-remote-resources" class="" aria-label="Chapter 24: Network Requests and Remote Resources"><!--[--><!--]--> Chapter 24: Network Requests and Remote Resources <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch25-client-side-storage" class="" aria-label="Chapter 25: Client-Side Storage"><!--[--><!--]--> Chapter 25: Client-Side Storage <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch26-modules" class="" aria-label="Chapter 26: Modules"><!--[--><!--]--> Chapter 26: Modules <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch27-workers" class="" aria-label="Chapter 27: Workers"><!--[--><!--]--> Chapter 27: Workers <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch28-best-practices" class="" aria-label="Chapter 28: Best Practices"><!--[--><!--]--> Chapter 28: Best Practices <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/apA-es2018-and-es2019" class="" aria-label="Appendix A: ES2018 and ES2019"><!--[--><!--]--> Appendix A: ES2018 and ES2019 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/apB-strct-mode" class="" aria-label="Appendix B: Strict Mode"><!--[--><!--]--> Appendix B: Strict Mode <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/apC-javascript-libraries-and-frameworks" class="" aria-label="Appendix C: JavaScript Libraries and Frameworks"><!--[--><!--]--> Appendix C: JavaScript Libraries and Frameworks <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/apD-javascript-tools" class="" aria-label="Appendix D: JavasScript Tools"><!--[--><!--]--> Appendix D: JavasScript Tools <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">Languages</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/ebooks/zh/you-dont-know-js-v1/scope-closures/ch2.html" class="" aria-label="简体中文"><!--[--><!--]--> 简体中文 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a aria-current="page" href="/ebooks/en/you-dont-know-js-v1/scope-closures/ch2.html" class="router-link-active router-link-exact-active router-link-active" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/us-fe/ebooks" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a class="external-link" href="https://us-fe.github.io" rel="noopener noreferrer" target="_blank" aria-label="US-FE"><!--[--><!--]--> US-FE <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a href="/ebooks/" class="router-link-active" aria-label="Home"><!--[--><!--]--> Home <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="You Don&#39;t Know JS"><span class="title">You Don&#39;t Know JS</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="You Don&#39;t Know JS"><span class="title">You Don&#39;t Know JS</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>V1</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/ebooks/en/you-dont-know-js-v1/up-going/" class="" aria-label="Up &amp; Going"><!--[--><!--]--> Up &amp; Going <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ebooks/en/you-dont-know-js-v1/scope-closures/" class="router-link-active" aria-label="Scope &amp; Closures"><!--[--><!--]--> Scope &amp; Closures <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ebooks/en/you-dont-know-js-v1/this-object-prototypes/" class="" aria-label="This &amp; Object Prototypes"><!--[--><!--]--> This &amp; Object Prototypes <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ebooks/en/you-dont-know-js-v1/types-grammar/" class="" aria-label="Types &amp; Grammar"><!--[--><!--]--> Types &amp; Grammar <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ebooks/en/you-dont-know-js-v1/async-performance/" class="" aria-label="Async &amp; Performance"><!--[--><!--]--> Async &amp; Performance <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ebooks/en/you-dont-know-js-v1/es6-beyond/" class="" aria-label="ES6 &amp; Beyond"><!--[--><!--]--> ES6 &amp; Beyond <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>V2</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/ebooks/en/you-dont-know-js-v2/get-started/" class="" aria-label="Get Started"><!--[--><!--]--> Get Started <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ebooks/en/you-dont-know-js-v2/scope-closures/" class="" aria-label="Scope &amp; Closures"><!--[--><!--]--> Scope &amp; Closures <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Professional Javascript for Web Developers V4"><span class="title">Professional Javascript for Web Developers V4</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Professional Javascript for Web Developers V4"><span class="title">Professional Javascript for Web Developers V4</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch1-what-is-javascript" class="" aria-label="Chapter 1: What Is JavaScript?"><!--[--><!--]--> Chapter 1: What Is JavaScript? <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch2-javascript-in-html" class="" aria-label="Chapter 2: JavaScript in HTML"><!--[--><!--]--> Chapter 2: JavaScript in HTML <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch3-language-basics" class="" aria-label="Chapter 3: Language Basics"><!--[--><!--]--> Chapter 3: Language Basics <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch4-variables-scope-and-memory" class="" aria-label="Chapter 4: Variables, Scope, and Memory"><!--[--><!--]--> Chapter 4: Variables, Scope, and Memory <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch5-basic-reference-types" class="" aria-label="Chapter 5: Basic Reference Types"><!--[--><!--]--> Chapter 5: Basic Reference Types <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch6-collection-reference-types" class="" aria-label="Chapter 6: Collection Reference Types"><!--[--><!--]--> Chapter 6: Collection Reference Types <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch7-iterators-and-generators" class="" aria-label="Chapter 7: Iterators and Generators"><!--[--><!--]--> Chapter 7: Iterators and Generators <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch8-objects-classes-and-object-oriented-programming" class="" aria-label="Chapter 8: Objects, Classes, and Object-Oriented Programming"><!--[--><!--]--> Chapter 8: Objects, Classes, and Object-Oriented Programming <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch9-proxies-and-reflect" class="" aria-label="Chapter 9: Proxies and Reflect"><!--[--><!--]--> Chapter 9: Proxies and Reflect <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch10-funtions" class="" aria-label="Chapter 10: Functions"><!--[--><!--]--> Chapter 10: Functions <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch11-promises-and-async-functions" class="" aria-label="Chapter 11: Promises and Async Functions"><!--[--><!--]--> Chapter 11: Promises and Async Functions <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch12-the-browser-object-model" class="" aria-label="Chapter 12: The Browser Object Model"><!--[--><!--]--> Chapter 12: The Browser Object Model <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch13-client-detection" class="" aria-label="Chapter 13: Client Detection"><!--[--><!--]--> Chapter 13: Client Detection <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch14-the-document-object-model" class="" aria-label="Chapter 14: The Document Object Model"><!--[--><!--]--> Chapter 14: The Document Object Model <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch15-dom-extensions" class="" aria-label="Chapter 15: DOM Extensions"><!--[--><!--]--> Chapter 15: DOM Extensions <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch16-dom-levels-2-and-3" class="" aria-label="Chapter 16: DOM Levels 2 and 3"><!--[--><!--]--> Chapter 16: DOM Levels 2 and 3 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch17-events" class="" aria-label="Chapter 17: Events"><!--[--><!--]--> Chapter 17: Events <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch18-animation-and-graphics-with-canvas" class="" aria-label="Chapter 18: Animation and Graphics with Canvas"><!--[--><!--]--> Chapter 18: Animation and Graphics with Canvas <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch19-scripting-forms" class="" aria-label="Chapter 19: Scripting Forms"><!--[--><!--]--> Chapter 19: Scripting Forms <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch20-javascript-apis" class="" aria-label="Chapter 20: JavaScript APIs"><!--[--><!--]--> Chapter 20: JavaScript APIs <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch21-error-handling-and-debugging" class="" aria-label="Chapter 21: Error Handling and Debugging"><!--[--><!--]--> Chapter 21: Error Handling and Debugging <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch22-xml-in-javascript" class="" aria-label="Chapter 22: XML in JavaScript"><!--[--><!--]--> Chapter 22: XML in JavaScript <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch23-json" class="" aria-label="Chapter 23: JSON"><!--[--><!--]--> Chapter 23: JSON <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch24-network-requests-and-remote-resources" class="" aria-label="Chapter 24: Network Requests and Remote Resources"><!--[--><!--]--> Chapter 24: Network Requests and Remote Resources <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch25-client-side-storage" class="" aria-label="Chapter 25: Client-Side Storage"><!--[--><!--]--> Chapter 25: Client-Side Storage <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch26-modules" class="" aria-label="Chapter 26: Modules"><!--[--><!--]--> Chapter 26: Modules <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch27-workers" class="" aria-label="Chapter 27: Workers"><!--[--><!--]--> Chapter 27: Workers <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/ch28-best-practices" class="" aria-label="Chapter 28: Best Practices"><!--[--><!--]--> Chapter 28: Best Practices <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/apA-es2018-and-es2019" class="" aria-label="Appendix A: ES2018 and ES2019"><!--[--><!--]--> Appendix A: ES2018 and ES2019 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/apB-strct-mode" class="" aria-label="Appendix B: Strict Mode"><!--[--><!--]--> Appendix B: Strict Mode <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/apC-javascript-libraries-and-frameworks" class="" aria-label="Appendix C: JavaScript Libraries and Frameworks"><!--[--><!--]--> Appendix C: JavaScript Libraries and Frameworks <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/ebooks/en/professional-javascript-for-web-developers-v4/apD-javascript-tools" class="" aria-label="Appendix D: JavasScript Tools"><!--[--><!--]--> Appendix D: JavasScript Tools <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">Languages</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/ebooks/zh/you-dont-know-js-v1/scope-closures/ch2.html" class="" aria-label="简体中文"><!--[--><!--]--> 简体中文 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a aria-current="page" href="/ebooks/en/you-dont-know-js-v1/scope-closures/ch2.html" class="router-link-active router-link-exact-active router-link-active" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/us-fe/ebooks" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">Up &amp; Going <span class="right arrow"></span></p><!--[--><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/ebooks/en/you-dont-know-js-v1/up-going/" class="sidebar-item" aria-label="README"><!--[--><!--]--> README <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/up-going/ch1" class="sidebar-item" aria-label="Chapter 1: Into Programming"><!--[--><!--]--> Chapter 1: Into Programming <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/up-going/ch2" class="sidebar-item" aria-label="Chapter 2: Into JavaScript"><!--[--><!--]--> Chapter 2: Into JavaScript <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/up-going/ch3" class="sidebar-item" aria-label="Chapter 3: Into YDKJS"><!--[--><!--]--> Chapter 3: Into YDKJS <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/up-going/apA" class="sidebar-item" aria-label="Appendix A: Acknowledgments"><!--[--><!--]--> Appendix A: Acknowledgments <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><p tabindex="0" class="sidebar-item sidebar-heading active collapsible">Scope &amp; Closures <span class="down arrow"></span></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a href="/ebooks/en/you-dont-know-js-v1/scope-closures/" class="router-link-active sidebar-item" aria-label="README"><!--[--><!--]--> README <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/scope-closures/toc" class="sidebar-item" aria-label="TOC"><!--[--><!--]--> TOC <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/scope-closures/ch1" class="sidebar-item" aria-label="Chapter 1: What is Scope?"><!--[--><!--]--> Chapter 1: What is Scope? <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/scope-closures/ch2" class="router-link-active sidebar-item active" aria-label="Chapter 2: Lexical Scope"><!--[--><!--]--> Chapter 2: Lexical Scope <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/scope-closures/ch3" class="sidebar-item" aria-label="Chapter 3: Function vs. Block Scope"><!--[--><!--]--> Chapter 3: Function vs. Block Scope <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/scope-closures/ch4" class="sidebar-item" aria-label="Chapter 4: Hoisting"><!--[--><!--]--> Chapter 4: Hoisting <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/scope-closures/ch5" class="sidebar-item" aria-label="Chapter 5: Scope Closure"><!--[--><!--]--> Chapter 5: Scope Closure <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/scope-closures/apA" class="sidebar-item" aria-label="Appendix A: Dynamic Scope"><!--[--><!--]--> Appendix A: Dynamic Scope <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/scope-closures/apB" class="sidebar-item" aria-label="Appendix B: Polyfilling Block Scope"><!--[--><!--]--> Appendix B: Polyfilling Block Scope <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/scope-closures/apC" class="sidebar-item" aria-label="Appendix C: Lexical-this"><!--[--><!--]--> Appendix C: Lexical-this <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/scope-closures/apD" class="sidebar-item" aria-label="Appendix D: Acknowledgments"><!--[--><!--]--> Appendix D: Acknowledgments <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">This &amp; Object Prototypes <span class="right arrow"></span></p><!--[--><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/ebooks/en/you-dont-know-js-v1/this-object-prototypes/" class="sidebar-item" aria-label="README"><!--[--><!--]--> README <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/this-object-prototypes/toc" class="sidebar-item" aria-label="TOC"><!--[--><!--]--> TOC <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/this-object-prototypes/ch1" class="sidebar-item" aria-label="Chapter 1: `this` Or That?"><!--[--><!--]--> Chapter 1: `this` Or That? <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/this-object-prototypes/ch2" class="sidebar-item" aria-label="Chapter 2: `this` All Makes Sense Now!"><!--[--><!--]--> Chapter 2: `this` All Makes Sense Now! <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/this-object-prototypes/ch3" class="sidebar-item" aria-label="Chapter 3: Objects"><!--[--><!--]--> Chapter 3: Objects <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/this-object-prototypes/ch4" class="sidebar-item" aria-label="Chapter 4: Mixing (Up) &quot;Class&quot; Objects"><!--[--><!--]--> Chapter 4: Mixing (Up) &quot;Class&quot; Objects <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/this-object-prototypes/ch5" class="sidebar-item" aria-label="Chapter 5: Prototypes"><!--[--><!--]--> Chapter 5: Prototypes <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/this-object-prototypes/ch3" class="sidebar-item" aria-label="Chapter 6: Behavior Delegation"><!--[--><!--]--> Chapter 6: Behavior Delegation <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/this-object-prototypes/apA" class="sidebar-item" aria-label="Appendix A: Acknowledgments"><!--[--><!--]--> Appendix A: Acknowledgments <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/this-object-prototypes/apB" class="sidebar-item" aria-label="Appendix A: Acknowledgments"><!--[--><!--]--> Appendix A: Acknowledgments <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">Types &amp; Grammar <span class="right arrow"></span></p><!--[--><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/ebooks/en/you-dont-know-js-v1/types-grammar/" class="sidebar-item" aria-label="README"><!--[--><!--]--> README <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/types-grammar/toc" class="sidebar-item" aria-label="TOC"><!--[--><!--]--> TOC <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/types-grammar/ch1" class="sidebar-item" aria-label="Chapter 1: Types"><!--[--><!--]--> Chapter 1: Types <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/types-grammar/ch2" class="sidebar-item" aria-label="Chapter 2: Values"><!--[--><!--]--> Chapter 2: Values <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/types-grammar/ch3" class="sidebar-item" aria-label="Chapter 3: Natives"><!--[--><!--]--> Chapter 3: Natives <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/types-grammar/ch4" class="sidebar-item" aria-label="Chapter 4: Coercion"><!--[--><!--]--> Chapter 4: Coercion <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/types-grammar/ch5" class="sidebar-item" aria-label="Chapter 5: Grammar"><!--[--><!--]--> Chapter 5: Grammar <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/types-grammar/apA" class="sidebar-item" aria-label="Appendix A: Mixed Environment JavaScript"><!--[--><!--]--> Appendix A: Mixed Environment JavaScript <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">Async &amp; Performance <span class="right arrow"></span></p><!--[--><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/ebooks/en/you-dont-know-js-v1/async-performance/" class="sidebar-item" aria-label="README"><!--[--><!--]--> README <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/async-performance/toc" class="sidebar-item" aria-label="TOC"><!--[--><!--]--> TOC <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/async-performance/ch1" class="sidebar-item" aria-label="Chapter 1: Asynchrony: Now &amp; Later"><!--[--><!--]--> Chapter 1: Asynchrony: Now &amp; Later <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/async-performance/ch2" class="sidebar-item" aria-label="Chapter 2: Callbacks"><!--[--><!--]--> Chapter 2: Callbacks <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/async-performance/ch3" class="sidebar-item" aria-label="Chapter 3: Promises"><!--[--><!--]--> Chapter 3: Promises <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/async-performance/ch4" class="sidebar-item" aria-label="Chapter 4: Generators"><!--[--><!--]--> Chapter 4: Generators <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/async-performance/ch5" class="sidebar-item" aria-label="Chapter 5: Program Performance"><!--[--><!--]--> Chapter 5: Program Performance <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/async-performance/ch6" class="sidebar-item" aria-label="Chapter 6: Benchmarking &amp; Tuning"><!--[--><!--]--> Chapter 6: Benchmarking &amp; Tuning <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/async-performance/apA" class="sidebar-item" aria-label="Appendix A: *asynquence* Library"><!--[--><!--]--> Appendix A: *asynquence* Library <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">ES6 &amp; Beyond <span class="right arrow"></span></p><!--[--><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/ebooks/en/you-dont-know-js-v1/es6-beyond/" class="sidebar-item" aria-label="README"><!--[--><!--]--> README <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/es6-beyond/toc" class="sidebar-item" aria-label="TOC"><!--[--><!--]--> TOC <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/es6-beyond/ch1" class="sidebar-item" aria-label="Chapter 1: ES? Now &amp; Future"><!--[--><!--]--> Chapter 1: ES? Now &amp; Future <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/es6-beyond/ch2" class="sidebar-item" aria-label="Chapter 2: Syntax"><!--[--><!--]--> Chapter 2: Syntax <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/es6-beyond/ch3" class="sidebar-item" aria-label="Chapter 3: Organization"><!--[--><!--]--> Chapter 3: Organization <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/es6-beyond/ch4" class="sidebar-item" aria-label="Chapter 4: Async Flow Control"><!--[--><!--]--> Chapter 4: Async Flow Control <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/es6-beyond/ch5" class="sidebar-item" aria-label="Chapter 5: Collections"><!--[--><!--]--> Chapter 5: Collections <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/es6-beyond/ch6" class="sidebar-item" aria-label="Chapter 6: API Additions"><!--[--><!--]--> Chapter 6: API Additions <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/es6-beyond/ch7" class="sidebar-item" aria-label="Chapter 7: Meta Programming"><!--[--><!--]--> Chapter 7: Meta Programming <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/es6-beyond/ch8" class="sidebar-item" aria-label="Chapter 8: Beyond ES6"><!--[--><!--]--> Chapter 8: Beyond ES6 <!--[--><!--]--></a><!----></li><li><a href="/ebooks/en/you-dont-know-js-v1/es6-beyond/apA" class="sidebar-item" aria-label="Appendix A: Acknowledgments"><!--[--><!--]--> Appendix A: Acknowledgments <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="you-don-t-know-js-scope-closures" tabindex="-1"><a class="header-anchor" href="#you-don-t-know-js-scope-closures" aria-hidden="true">#</a> You Don&#39;t Know JS: Scope &amp; Closures</h1><h1 id="chapter-2-lexical-scope" tabindex="-1"><a class="header-anchor" href="#chapter-2-lexical-scope" aria-hidden="true">#</a> Chapter 2: Lexical Scope</h1><p>In Chapter 1, we defined &quot;scope&quot; as the set of rules that govern how the <em>Engine</em> can look up a variable by its identifier name and find it, either in the current <em>Scope</em>, or in any of the <em>Nested Scopes</em> it&#39;s contained within.</p><p>There are two predominant models for how scope works. The first of these is by far the most common, used by the vast majority of programming languages. It&#39;s called <strong>Lexical Scope</strong>, and we will examine it in-depth. The other model, which is still used by some languages (such as Bash scripting, some modes in Perl, etc.) is called <strong>Dynamic Scope</strong>.</p><p>Dynamic Scope is covered in Appendix A. I mention it here only to provide a contrast with Lexical Scope, which is the scope model that JavaScript employs.</p><h2 id="lex-time" tabindex="-1"><a class="header-anchor" href="#lex-time" aria-hidden="true">#</a> Lex-time</h2><p>As we discussed in Chapter 1, the first traditional phase of a standard language compiler is called lexing (aka, tokenizing). If you recall, the lexing process examines a string of source code characters and assigns semantic meaning to the tokens as a result of some stateful parsing.</p><p>It is this concept which provides the foundation to understand what lexical scope is and where the name comes from.</p><p>To define it somewhat circularly, lexical scope is scope that is defined at lexing time. In other words, lexical scope is based on where variables and blocks of scope are authored, by you, at write time, and thus is (mostly) set in stone by the time the lexer processes your code.</p><p><strong>Note:</strong> We will see in a little bit there are some ways to cheat lexical scope, thereby modifying it after the lexer has passed by, but these are frowned upon. It is considered best practice to treat lexical scope as, in fact, lexical-only, and thus entirely author-time in nature.</p><p>Let&#39;s consider this block of code:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token keyword">var</span> b <span class="token operator">=</span> a <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>

	<span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token parameter">c</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c <span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">bar</span><span class="token punctuation">(</span>b <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">foo</span><span class="token punctuation">(</span> <span class="token number">2</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2 4 12</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>There are three nested scopes inherent in this code example. It may be helpful to think about these scopes as bubbles inside of each other.</p><img src="/ebooks/you-dont-know-js-v1/scope-closures/fig2.png" width="500"><p><strong>Bubble 1</strong> encompasses the global scope, and has just one identifier in it: <code>foo</code>.</p><p><strong>Bubble 2</strong> encompasses the scope of <code>foo</code>, which includes the three identifiers: <code>a</code>, <code>bar</code> and <code>b</code>.</p><p><strong>Bubble 3</strong> encompasses the scope of <code>bar</code>, and it includes just one identifier: <code>c</code>.</p><p>Scope bubbles are defined by where the blocks of scope are written, which one is nested inside the other, etc. In the next chapter, we&#39;ll discuss different units of scope, but for now, let&#39;s just assume that each function creates a new bubble of scope.</p><p>The bubble for <code>bar</code> is entirely contained within the bubble for <code>foo</code>, because (and only because) that&#39;s where we chose to define the function <code>bar</code>.</p><p>Notice that these nested bubbles are strictly nested. We&#39;re not talking about Venn diagrams where the bubbles can cross boundaries. In other words, no bubble for some function can simultaneously exist (partially) inside two other outer scope bubbles, just as no function can partially be inside each of two parent functions.</p><h3 id="look-ups" tabindex="-1"><a class="header-anchor" href="#look-ups" aria-hidden="true">#</a> Look-ups</h3><p>The structure and relative placement of these scope bubbles fully explains to the <em>Engine</em> all the places it needs to look to find an identifier.</p><p>In the above code snippet, the <em>Engine</em> executes the <code>console.log(..)</code> statement and goes looking for the three referenced variables <code>a</code>, <code>b</code>, and <code>c</code>. It first starts with the innermost scope bubble, the scope of the <code>bar(..)</code> function. It won&#39;t find <code>a</code> there, so it goes up one level, out to the next nearest scope bubble, the scope of <code>foo(..)</code>. It finds <code>a</code> there, and so it uses that <code>a</code>. Same thing for <code>b</code>. But <code>c</code>, it does find inside of <code>bar(..)</code>.</p><p>Had there been a <code>c</code> both inside of <code>bar(..)</code> and inside of <code>foo(..)</code>, the <code>console.log(..)</code> statement would have found and used the one in <code>bar(..)</code>, never getting to the one in <code>foo(..)</code>.</p><p><strong>Scope look-up stops once it finds the first match</strong>. The same identifier name can be specified at multiple layers of nested scope, which is called &quot;shadowing&quot; (the inner identifier &quot;shadows&quot; the outer identifier). Regardless of shadowing, scope look-up always starts at the innermost scope being executed at the time, and works its way outward/upward until the first match, and stops.</p><p><strong>Note:</strong> Global variables are also automatically properties of the global object (<code>window</code> in browsers, etc.), so it <em>is</em> possible to reference a global variable not directly by its lexical name, but instead indirectly as a property reference of the global object.</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>window<span class="token punctuation">.</span>a
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>This technique gives access to a global variable which would otherwise be inaccessible due to it being shadowed. However, non-global shadowed variables cannot be accessed.</p><p>No matter <em>where</em> a function is invoked from, or even <em>how</em> it is invoked, its lexical scope is <strong>only</strong> defined by where the function was declared.</p><p>The lexical scope look-up process <em>only</em> applies to first-class identifiers, such as the <code>a</code>, <code>b</code>, and <code>c</code>. If you had a reference to <code>foo.bar.baz</code> in a piece of code, the lexical scope look-up would apply to finding the <code>foo</code> identifier, but once it locates that variable, object property-access rules take over to resolve the <code>bar</code> and <code>baz</code> properties, respectively.</p><h2 id="cheating-lexical" tabindex="-1"><a class="header-anchor" href="#cheating-lexical" aria-hidden="true">#</a> Cheating Lexical</h2><p>If lexical scope is defined only by where a function is declared, which is entirely an author-time decision, how could there possibly be a way to &quot;modify&quot; (aka, cheat) lexical scope at run-time?</p><p>JavaScript has two such mechanisms. Both of them are equally frowned-upon in the wider community as bad practices to use in your code. But the typical arguments against them are often missing the most important point: <strong>cheating lexical scope leads to poorer performance.</strong></p><p>Before I explain the performance issue, though, let&#39;s look at how these two mechanisms work.</p><h3 id="eval" tabindex="-1"><a class="header-anchor" href="#eval" aria-hidden="true">#</a> <code>eval</code></h3><p>The <code>eval(..)</code> function in JavaScript takes a string as an argument, and treats the contents of the string as if it had actually been authored code at that point in the program. In other words, you can programmatically generate code inside of your authored code, and run the generated code as if it had been there at author time.</p><p>Evaluating <code>eval(..)</code> (pun intended) in that light, it should be clear how <code>eval(..)</code> allows you to modify the lexical scope environment by cheating and pretending that author-time (aka, lexical) code was there all along.</p><p>On subsequent lines of code after an <code>eval(..)</code> has executed, the <em>Engine</em> will not &quot;know&quot; or &quot;care&quot; that the previous code in question was dynamically interpreted and thus modified the lexical scope environment. The <em>Engine</em> will simply perform its lexical scope look-ups as it always does.</p><p>Consider the following code:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">str<span class="token punctuation">,</span> a</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">eval</span><span class="token punctuation">(</span> str <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// cheating!</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> a<span class="token punctuation">,</span> b <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>

<span class="token function">foo</span><span class="token punctuation">(</span> <span class="token string">&quot;var b = 3;&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1 3</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>The string <code>&quot;var b = 3;&quot;</code> is treated, at the point of the <code>eval(..)</code> call, as code that was there all along. Because that code happens to declare a new variable <code>b</code>, it modifies the existing lexical scope of <code>foo(..)</code>. In fact, as mentioned above, this code actually creates variable <code>b</code> inside of <code>foo(..)</code> that shadows the <code>b</code> that was declared in the outer (global) scope.</p><p>When the <code>console.log(..)</code> call occurs, it finds both <code>a</code> and <code>b</code> in the scope of <code>foo(..)</code>, and never finds the outer <code>b</code>. Thus, we print out &quot;1 3&quot; instead of &quot;1 2&quot; as would have normally been the case.</p><p><strong>Note:</strong> In this example, for simplicity&#39;s sake, the string of &quot;code&quot; we pass in was a fixed literal. But it could easily have been programmatically created by adding characters together based on your program&#39;s logic. <code>eval(..)</code> is usually used to execute dynamically created code, as dynamically evaluating essentially static code from a string literal would provide no real benefit to just authoring the code directly.</p><p>By default, if a string of code that <code>eval(..)</code> executes contains one or more declarations (either variables or functions), this action modifies the existing lexical scope in which the <code>eval(..)</code> resides. Technically, <code>eval(..)</code> can be invoked &quot;indirectly&quot;, through various tricks (beyond our discussion here), which causes it to instead execute in the context of the global scope, thus modifying it. But in either case, <code>eval(..)</code> can at runtime modify an author-time lexical scope.</p><p><strong>Note:</strong> <code>eval(..)</code> when used in a strict-mode program operates in its own lexical scope, which means declarations made inside of the <code>eval()</code> do not actually modify the enclosing scope.</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token string">&quot;use strict&quot;</span><span class="token punctuation">;</span>
   <span class="token function">eval</span><span class="token punctuation">(</span> str <span class="token punctuation">)</span><span class="token punctuation">;</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> a <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ReferenceError: a is not defined</span>
<span class="token punctuation">}</span>

<span class="token function">foo</span><span class="token punctuation">(</span> <span class="token string">&quot;var a = 2&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>There are other facilities in JavaScript which amount to a very similar effect to <code>eval(..)</code>. <code>setTimeout(..)</code> and <code>setInterval(..)</code> <em>can</em> take a string for their respective first argument, the contents of which are <code>eval</code>uated as the code of a dynamically-generated function. This is old, legacy behavior and long-since deprecated. Don&#39;t do it!</p><p>The <code>new Function(..)</code> function constructor similarly takes a string of code in its <strong>last</strong> argument to turn into a dynamically-generated function (the first argument(s), if any, are the named parameters for the new function). This function-constructor syntax is slightly safer than <code>eval(..)</code>, but it should still be avoided in your code.</p><p>The use-cases for dynamically generating code inside your program are incredibly rare, as the performance degradations are almost never worth the capability.</p><h3 id="with" tabindex="-1"><a class="header-anchor" href="#with" aria-hidden="true">#</a> <code>with</code></h3><p>The other frowned-upon (and now deprecated!) feature in JavaScript which cheats lexical scope is the <code>with</code> keyword. There are multiple valid ways that <code>with</code> can be explained, but I will choose here to explain it from the perspective of how it interacts with and affects lexical scope.</p><p><code>with</code> is typically explained as a short-hand for making multiple property references against an object <em>without</em> repeating the object reference itself each time.</p><p>For example:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
	<span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
	<span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token number">3</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// more &quot;tedious&quot; to repeat &quot;obj&quot;</span>
obj<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span>c <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>

<span class="token comment">// &quot;easier&quot; short-hand</span>
<span class="token keyword">with</span> <span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	a <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
	b <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
	c <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>However, there&#39;s much more going on here than just a convenient short-hand for object property access. Consider:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">with</span> <span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> o1 <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">3</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> o2 <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token number">3</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">foo</span><span class="token punctuation">(</span> o1 <span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> o1<span class="token punctuation">.</span>a <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2</span>

<span class="token function">foo</span><span class="token punctuation">(</span> o2 <span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> o2<span class="token punctuation">.</span>a <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> a <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2 -- Oops, leaked global!</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>In this code example, two objects <code>o1</code> and <code>o2</code> are created. One has an <code>a</code> property, and the other does not. The <code>foo(..)</code> function takes an object reference <code>obj</code> as an argument, and calls <code>with (obj) { .. }</code> on the reference. Inside the <code>with</code> block, we make what appears to be a normal lexical reference to a variable <code>a</code>, an LHS reference in fact (see Chapter 1), to assign to it the value of <code>2</code>.</p><p>When we pass in <code>o1</code>, the <code>a = 2</code> assignment finds the property <code>o1.a</code> and assigns it the value <code>2</code>, as reflected in the subsequent <code>console.log(o1.a)</code> statement. However, when we pass in <code>o2</code>, since it does not have an <code>a</code> property, no such property is created, and <code>o2.a</code> remains <code>undefined</code>.</p><p>But then we note a peculiar side-effect, the fact that a global variable <code>a</code> was created by the <code>a = 2</code> assignment. How can this be?</p><p>The <code>with</code> statement takes an object, one which has zero or more properties, and <strong>treats that object as if <em>it</em> is a wholly separate lexical scope</strong>, and thus the object&#39;s properties are treated as lexically defined identifiers in that &quot;scope&quot;.</p><p><strong>Note:</strong> Even though a <code>with</code> block treats an object like a lexical scope, a normal <code>var</code> declaration inside that <code>with</code> block will not be scoped to that <code>with</code> block, but instead the containing function scope.</p><p>While the <code>eval(..)</code> function can modify existing lexical scope if it takes a string of code with one or more declarations in it, the <code>with</code> statement actually creates a <strong>whole new lexical scope</strong> out of thin air, from the object you pass to it.</p><p>Understood in this way, the &quot;scope&quot; declared by the <code>with</code> statement when we passed in <code>o1</code> was <code>o1</code>, and that &quot;scope&quot; had an &quot;identifier&quot; in it which corresponds to the <code>o1.a</code> property. But when we used <code>o2</code> as the &quot;scope&quot;, it had no such <code>a</code> &quot;identifier&quot; in it, and so the normal rules of LHS identifier look-up (see Chapter 1) occurred.</p><p>Neither the &quot;scope&quot; of <code>o2</code>, nor the scope of <code>foo(..)</code>, nor the global scope even, has an <code>a</code> identifier to be found, so when <code>a = 2</code> is executed, it results in the automatic-global being created (since we&#39;re in non-strict mode).</p><p>It is a strange sort of mind-bending thought to see <code>with</code> turning, at runtime, an object and its properties into a &quot;scope&quot; <em>with</em> &quot;identifiers&quot;. But that is the clearest explanation I can give for the results we see.</p><p><strong>Note:</strong> In addition to being a bad idea to use, both <code>eval(..)</code> and <code>with</code> are affected (restricted) by Strict Mode. <code>with</code> is outright disallowed, whereas various forms of indirect or unsafe <code>eval(..)</code> are disallowed while retaining the core functionality.</p><h3 id="performance" tabindex="-1"><a class="header-anchor" href="#performance" aria-hidden="true">#</a> Performance</h3><p>Both <code>eval(..)</code> and <code>with</code> cheat the otherwise author-time defined lexical scope by modifying or creating new lexical scope at runtime.</p><p>So, what&#39;s the big deal, you ask? If they offer more sophisticated functionality and coding flexibility, aren&#39;t these <em>good</em> features? <strong>No.</strong></p><p>The JavaScript <em>Engine</em> has a number of performance optimizations that it performs during the compilation phase. Some of these boil down to being able to essentially statically analyze the code as it lexes, and pre-determine where all the variable and function declarations are, so that it takes less effort to resolve identifiers during execution.</p><p>But if the <em>Engine</em> finds an <code>eval(..)</code> or <code>with</code> in the code, it essentially has to <em>assume</em> that all its awareness of identifier location may be invalid, because it cannot know at lexing time exactly what code you may pass to <code>eval(..)</code> to modify the lexical scope, or the contents of the object you may pass to <code>with</code> to create a new lexical scope to be consulted.</p><p>In other words, in the pessimistic sense, most of those optimizations it <em>would</em> make are pointless if <code>eval(..)</code> or <code>with</code> are present, so it simply doesn&#39;t perform the optimizations <em>at all</em>.</p><p>Your code will almost certainly tend to run slower simply by the fact that you include an <code>eval(..)</code> or <code>with</code> anywhere in the code. No matter how smart the <em>Engine</em> may be about trying to limit the side-effects of these pessimistic assumptions, <strong>there&#39;s no getting around the fact that without the optimizations, code runs slower.</strong></p><h2 id="review-tl-dr" tabindex="-1"><a class="header-anchor" href="#review-tl-dr" aria-hidden="true">#</a> Review (TL;DR)</h2><p>Lexical scope means that scope is defined by author-time decisions of where functions are declared. The lexing phase of compilation is essentially able to know where and how all identifiers are declared, and thus predict how they will be looked-up during execution.</p><p>Two mechanisms in JavaScript can &quot;cheat&quot; lexical scope: <code>eval(..)</code> and <code>with</code>. The former can modify existing lexical scope (at runtime) by evaluating a string of &quot;code&quot; which has one or more declarations in it. The latter essentially creates a whole new lexical scope (again, at runtime) by treating an object reference <em>as</em> a &quot;scope&quot; and that object&#39;s properties as scoped identifiers.</p><p>The downside to these mechanisms is that it defeats the <em>Engine</em>&#39;s ability to perform compile-time optimizations regarding scope look-up, because the <em>Engine</em> has to assume pessimistically that such optimizations will be invalid. Code <em>will</em> run slower as a result of using either feature. <strong>Don&#39;t use them.</strong></p><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/us-fe/ebooks/edit/master/docs/en/you-dont-know-js-v1/scope-closures/ch2.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page"><!--[--><!--]--> Edit this page <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: yanqi.zyq@antfin.com">yanqi</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--[--><div class="giscus-wrapper input-top" style="display:block;"><giscus-widget repo="us-fe/ebooks" repoId="R_kgDOHQs-GA" category="Announcements" categoryId="DIC_kwDOHQs-GM4CO312" lang="en" theme="light" mapping="pathname" inputPosition="top" reactionsEnabled="1" emitMetadata="0"></giscus-widget></div><!--]--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/ebooks/assets/app.a957722f.js" defer></script>
  </body>
</html>
